/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');

/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function getActiveView(app) {
    const activeView = app.workspace.getActiveViewOfType(obsidian.MarkdownView);
    return activeView !== null && activeView !== void 0 ? activeView : undefined;
}
function isViewActive(app) {
    const activeView = getActiveView(app);
    if (activeView && activeView.file)
        return true;
    return false;
}
function getViewMetadata(app) {
    const activeView = getActiveView(app);
    if (activeView && activeView.file) {
        const data = app.metadataCache.getFileCache(activeView.file) || {};
        return data;
    }
    return undefined;
}
function getViewInfo(app) {
    const activeView = getActiveView(app);
    const data = getViewMetadata(app);
    const editor = activeView ? activeView.editor : undefined;
    if (activeView && data && editor) {
        return {
            activeView, data, editor
        };
    }
    return undefined;
}

const DEFAULT_SETTINGS = {
    skipTopLevel: false,
    firstLevel: 1,
    maxLevel: 6,
    styleLevel1: '1',
    styleLevelOther: '1',
    auto: false,
    separator: '',
    contents: ''
};
function isValidLevelStyle(s) {
    if (s === 'A' || s === '1')
        return true;
    return false;
}
function isValidFlag(f) {
    if (f === true || f === false)
        return true;
    return false;
}
function isValidFirstOrMaxLevel(x) {
    if (typeof x === 'number' && x >= 1 && x <= 6)
        return true;
    return false;
}
function isValidSeparator(x) {
    if (typeof x === 'string' && (x === '' || x === ':' || x === '.' || x === '-'))
        return true;
    return false;
}
function isValidContents(x) {
    if (typeof x === 'string' && (x === '' || x.startsWith('^')))
        return true;
    return false;
}
function doesContentsHaveValue(x) {
    if (x.length > 2 && x.startsWith('^'))
        return true;
    return false;
}

const AUTO_PART_KEY = 'auto';
const FIRST_LEVEL_PART_KEY = 'first-level';
const MAX_LEVEL_PART_KEY = 'max';
const CONTENTS_PART_KEY = 'contents';
function parseCompactFrontMatterSettings(fm) {
    const entry = obsidian.parseFrontMatterEntry(fm, 'number headings');
    if (entry) {
        const entryString = String(entry);
        const parts = entryString.split(',');
        const settings = Object.assign({}, DEFAULT_SETTINGS);
        for (const part of parts) {
            const cleanPart = part.trim();
            if (cleanPart.length === 0)
                continue;
            if (cleanPart === AUTO_PART_KEY) {
                // Parse auto numbering part
                settings.auto = true;
            }
            else if (cleanPart.startsWith(FIRST_LEVEL_PART_KEY)) {
                // Parse first level part
                const nstring = cleanPart.substring(FIRST_LEVEL_PART_KEY.length + 1);
                const n = parseInt(nstring);
                if (isValidFirstOrMaxLevel(n)) {
                    settings.firstLevel = n;
                }
            }
            else if (cleanPart.startsWith(MAX_LEVEL_PART_KEY)) {
                // Parse max level part
                const nstring = cleanPart.substring(MAX_LEVEL_PART_KEY.length + 1);
                const n = parseInt(nstring);
                if (isValidFirstOrMaxLevel(n)) {
                    settings.maxLevel = n;
                }
            }
            else if (cleanPart.startsWith(CONTENTS_PART_KEY)) {
                if (cleanPart.length <= CONTENTS_PART_KEY.length + 1)
                    continue;
                // Parse contents heading part
                const tocHeading = cleanPart.substring(CONTENTS_PART_KEY.length + 1);
                if (isValidContents(tocHeading)) {
                    settings.contents = tocHeading;
                }
            }
            else {
                // Parse formatting part
                const lastChar = cleanPart[cleanPart.length - 1];
                let remainingPart = cleanPart;
                if (isValidSeparator(lastChar)) {
                    settings.separator = lastChar;
                    remainingPart = cleanPart.substring(0, cleanPart.length - 1);
                }
                const descriptors = remainingPart.split('.');
                let firstNumberedDescriptor = 0;
                if (descriptors.length > 1 && descriptors[0] === '_') {
                    settings.skipTopLevel = true;
                    firstNumberedDescriptor = 1;
                }
                else {
                    settings.skipTopLevel = false;
                }
                if (descriptors.length - firstNumberedDescriptor >= 2) {
                    const styleLevel1 = descriptors[firstNumberedDescriptor];
                    if (isValidLevelStyle(styleLevel1)) {
                        settings.styleLevel1 = styleLevel1;
                    }
                    const styleLevelOther = descriptors[firstNumberedDescriptor + 1];
                    if (isValidLevelStyle(styleLevelOther)) {
                        settings.styleLevelOther = styleLevelOther;
                    }
                }
            }
        }
        return settings;
    }
    return undefined;
}
const getFrontMatterSettingsOrAlternative = ({ frontmatter }, alternativeSettings) => {
    var _a, _b, _c, _d, _e;
    if (frontmatter !== undefined) {
        const decompactedSettings = parseCompactFrontMatterSettings(frontmatter);
        if (decompactedSettings !== undefined)
            return decompactedSettings;
        // NOTE: Everything below is for backwards compatibility only
        const skipTopLevelEntry = (_a = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-skip-top-level')) !== null && _a !== void 0 ? _a : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-skip-top-level');
        const skipTopLevel = isValidFlag(skipTopLevelEntry) ? skipTopLevelEntry : alternativeSettings.skipTopLevel;
        const maxLevelEntry = (_b = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-max-level')) !== null && _b !== void 0 ? _b : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-max-level');
        const maxLevel = isValidFirstOrMaxLevel(maxLevelEntry) ? maxLevelEntry : alternativeSettings.maxLevel;
        const styleLevel1Entry = String((_c = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-style-level-1')) !== null && _c !== void 0 ? _c : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-style-level-1'));
        const styleLevel1 = isValidLevelStyle(styleLevel1Entry) ? styleLevel1Entry : alternativeSettings.styleLevel1;
        const styleLevelOtherEntry = String((_d = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-style-level-other')) !== null && _d !== void 0 ? _d : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-style-level-other'));
        const styleLevelOther = isValidLevelStyle(styleLevelOtherEntry) ? styleLevelOtherEntry : alternativeSettings.styleLevelOther;
        const autoEntry = (_e = obsidian.parseFrontMatterEntry(frontmatter, 'number-headings-auto')) !== null && _e !== void 0 ? _e : obsidian.parseFrontMatterEntry(frontmatter, 'header-numbering-auto');
        const auto = isValidFlag(autoEntry) ? autoEntry : alternativeSettings.auto;
        return Object.assign(Object.assign({}, alternativeSettings), { skipTopLevel, maxLevel, styleLevel1, styleLevelOther, auto });
    }
    else {
        return alternativeSettings;
    }
};
function settingsToCompactFrontMatterValue(settings) {
    const autoPart = settings.auto ? 'auto, ' : '';
    const firstLevelPart = `first-level ${settings.firstLevel}, `;
    const maxPart = `max ${settings.maxLevel}, `;
    const contentsPart = settings.contents && settings.contents.length > 0 ? `contents ${settings.contents}, ` : '';
    const skipTopLevelString = settings.skipTopLevel ? '_.' : '';
    const stylePart = `${skipTopLevelString}${settings.styleLevel1}.${settings.styleLevelOther}${settings.separator}`;
    return autoPart + firstLevelPart + maxPart + contentsPart + stylePart;
}
function findLineWhichStartsWith(editor, search, afterLine) {
    // Find the location of the frontmatter
    for (let i = afterLine; i < editor.lastLine(); i++) {
        const lineString = editor.getLine(i);
        if (lineString.startsWith(search)) {
            return i;
        }
    }
    return undefined;
}
const saveSettingsToFrontMatter = ({ frontmatter }, editor, settings) => {
    if (frontmatter !== undefined) {
        // Front matter already exists, so we'll need to insert the settings into the front matter
        const frontMatterLine = frontmatter.position.start.line;
        const v = settingsToCompactFrontMatterValue(settings);
        const frontMatterAdditions = `number headings: ${v}\n`;
        if (frontmatter['number headings'] !== undefined) {
            // Key already present, replace it
            const keyLine = findLineWhichStartsWith(editor, 'number headings', frontMatterLine);
            if (keyLine === undefined)
                throw new Error('Number Headings Plugin: "number headings" key exists but not found.');
            const from = { line: keyLine, ch: 0 };
            const to = { line: keyLine + 1, ch: 0 };
            editor.replaceRange(frontMatterAdditions, from, to);
        }
        else {
            // Key not present, insert new key
            const from = { line: frontMatterLine + 1, ch: 0 };
            const to = { line: frontMatterLine + 1, ch: 0 };
            editor.replaceRange(frontMatterAdditions, from, to);
        }
    }
    else {
        // No frontmatter found, create frontmatter from scratch
        const v = settingsToCompactFrontMatterValue(settings);
        const newFrontMatter = `---\nnumber headings: ${v}\n---\n\n`;
        const from = { line: 0, ch: 0 };
        const to = { line: 0, ch: 0 };
        editor.replaceRange(newFrontMatter, from, to);
        // Front matter does not exist, so we will create it from scratch
    }
};

class NumberingDoneModal extends obsidian.Modal {
    constructor(app, config) {
        super(app);
        this.config = config;
    }
    onOpen() {
        const { contentEl, titleEl } = this;
        titleEl.setText('Number Headings - Successfully Completed');
        contentEl.createEl('div', { text: this.config.message });
        contentEl.createEl('pre', { text: this.config.preformattedMessage });
        contentEl.createEl('div', { text: "Do you want to save these settings in the document's front matter?", cls: 'number-headings-question' });
        const containerForButtons = contentEl.createEl('div', { cls: 'number-headings-button-container' });
        const noButton = containerForButtons.createEl('button', {});
        noButton.setText('No');
        noButton.onClickEvent((ev) => {
            this.close();
            return ev;
        });
        const yesButton = containerForButtons.createEl('button', {});
        yesButton.setText('Yes, save settings in document');
        yesButton.onClickEvent((ev) => {
            this.config.saveSettingsCallback(false);
            this.close();
            return ev;
        });
        const yesAndAutoButton = containerForButtons.createEl('button', {});
        yesAndAutoButton.setText('Yes, save settings in document, and automatically number');
        yesAndAutoButton.onClickEvent((ev) => {
            this.config.saveSettingsCallback(true);
            this.close();
            return ev;
        });
    }
    onClose() {
        const { contentEl, titleEl } = this;
        contentEl.empty();
        titleEl.empty();
    }
}
function showNumberingDoneMessage(app, settings, viewInfo) {
    const saveSettingsCallback = (shouldAddAutoFlag) => {
        const tweakedSettings = Object.assign({}, settings);
        if (shouldAddAutoFlag)
            tweakedSettings.auto = true;
        saveSettingsToFrontMatter(viewInfo.data, viewInfo.editor, tweakedSettings);
    };
    const config = {
        message: `Successfully updated all heading numbers in the document, using the settings below. 
      See settings panel to change how headings are numbered, or use front matter
      (see settings panel).`,
        preformattedMessage: `  Skip top heading level: ${settings.skipTopLevel}
First heading level: ${settings.firstLevel}
Maximum heading level: ${settings.maxLevel}
Style for level 1 headings: ${settings.styleLevel1}
Style for lower level headings (below level 1): ${settings.styleLevelOther}
Separator: ${settings.separator}
Table of Contents Anchor: ${settings.contents}`,
        saveSettingsCallback
    };
    const leaf = app.workspace.activeLeaf;
    if (leaf) {
        new NumberingDoneModal(app, config).open();
    }
}

const TOC_LIST_ITEM_BULLET = '-';
function makeHeadingHashString(editor, heading) {
    const regex = /^\s{0,4}#+/g;
    const headingLineString = editor.getLine(heading.position.start.line);
    if (!headingLineString)
        return undefined;
    const matches = headingLineString.match(regex);
    if (!matches)
        return undefined;
    if (matches.length !== 1) {
        // eslint-disable-next-line no-console
        console.log("Unexpected heading format: '" + headingLineString + "'");
        return undefined;
    }
    const match = matches[0];
    return match.trimLeft();
}
function makeNumberingString(numberingStack) {
    let numberingString = '';
    for (let i = 0; i < numberingStack.length; i++) {
        if (i === 0) {
            numberingString += ' ';
        }
        else {
            numberingString += '.';
        }
        numberingString += numberingStack[i].toString();
    }
    return numberingString;
}
function getHeadingPrefixRange(editor, heading) {
    const regex = /^\s{0,4}#+( )?([0-9]+\.|[A-Z]\.)*([0-9]+|[A-Z])?[:.-]?( )+/g;
    const headingLineString = editor.getLine(heading.position.start.line);
    if (!headingLineString)
        return undefined;
    const matches = headingLineString.match(regex);
    if (matches && matches.length !== 1) {
        // eslint-disable-next-line no-console
        console.log("Unexpected heading format: '" + headingLineString + "'");
        return undefined;
    }
    const match = matches ? matches[0] : '';
    const from = {
        line: heading.position.start.line,
        ch: 0
    };
    const to = {
        line: heading.position.start.line,
        ch: match.length
    };
    return { from, to };
}
function zerothNumberingTokenInStyle(style) {
    if (style === '1') {
        return 0;
    }
    else if (style === 'A') {
        return 'Z';
    }
    return 0;
}
function firstNumberingTokenInStyle(style) {
    if (style === '1') {
        return 1;
    }
    else if (style === 'A') {
        return 'A';
    }
    return 1;
}
function nextNumberingToken(t) {
    if (typeof t === 'number') {
        return t + 1;
    }
    if (typeof t === 'string') {
        if (t === 'Z')
            return 'A';
        else
            return String.fromCharCode(t.charCodeAt(0) + 1);
    }
    return 1;
}
function cleanHeadingTextForToc(htext) {
    if (htext.contains('^')) {
        const x = htext.split('^');
        if (x.length > 1) {
            return x[0].trim();
        }
    }
    return htext.trim();
}
// eslint-disable-next-line @typescript-eslint/no-unused-vars
function createTocEntry(h, settings, initialHeadingLevel) {
    const text = h.heading;
    const cleanText = cleanHeadingTextForToc(text);
    let bulletIndent = '';
    const startLevel = initialHeadingLevel;
    for (let i = startLevel; i < h.level; i++) {
        bulletIndent += '\t';
    }
    const entryLink = `[[#${text}|${cleanText}]]`;
    return bulletIndent + TOC_LIST_ITEM_BULLET + ' ' + entryLink;
}
// Replace a range, but only if there is a change in text, to prevent poluting the undo stack
function replaceRangeSafely(editor, changes, range, text) {
    const previousText = editor.getRange(range.from, range.to);
    if (previousText !== text) {
        changes.push({
            text: text,
            from: range.from,
            to: range.to
        });
    }
}
const updateHeadingNumbering = (viewInfo, settings) => {
    var _a;
    if (!viewInfo)
        return;
    const headings = (_a = viewInfo.data.headings) !== null && _a !== void 0 ? _a : [];
    const editor = viewInfo.editor;
    let previousLevel = 1;
    let numberingStack = [zerothNumberingTokenInStyle(settings.styleLevel1)];
    if (settings.firstLevel > 1) {
        previousLevel = settings.firstLevel;
    }
    else if (settings.skipTopLevel) {
        previousLevel = 2;
    }
    const changes = [];
    for (const heading of headings) {
        // Update the numbering stack based on the level and previous level
        const level = heading.level;
        // Handle skipped & ignored levels.
        if ((settings.firstLevel > level) || (settings.skipTopLevel && level === 1)) {
            // Resets the numbering when a level is skipped.
            // Note: This leaves headings as they are, allowing people to have numbers at the start of
            // ignored headings.
            numberingStack = [zerothNumberingTokenInStyle(settings.styleLevel1)];
            if (settings.firstLevel > 1) {
                previousLevel = settings.firstLevel;
            }
            else if (settings.skipTopLevel) {
                previousLevel = 2;
            }
            continue;
        }
        // Adjust numbering stack
        if (level === previousLevel) {
            const x = numberingStack.pop();
            if (x !== undefined) {
                numberingStack.push(nextNumberingToken(x));
            }
        }
        else if (level < previousLevel) {
            for (let i = previousLevel; i > level; i--) {
                numberingStack.pop();
            }
            const x = numberingStack.pop();
            if (x !== undefined) {
                numberingStack.push(nextNumberingToken(x));
            }
        }
        else if (level > previousLevel) {
            for (let i = previousLevel; i < level; i++) {
                numberingStack.push(firstNumberingTokenInStyle(settings.styleLevelOther));
            }
        }
        // Set the previous level to this level for the next iteration
        previousLevel = level;
        if (level > settings.maxLevel) {
            // If we are above the max level, just don't number it
            continue;
        }
        // Find the range to replace, and then do it
        const prefixRange = getHeadingPrefixRange(editor, heading);
        if (prefixRange === undefined)
            return;
        const headingHashString = makeHeadingHashString(editor, heading);
        if (headingHashString === undefined)
            return;
        const prefixString = makeNumberingString(numberingStack);
        replaceRangeSafely(editor, changes, prefixRange, headingHashString + prefixString + settings.separator + ' ');
    }
    // Execute the transaction to make all the changes at once
    if (changes.length > 0) {
        // eslint-disable-next-line no-console
        console.log('Number Headings Plugin: Applying headings numbering changes:', changes.length);
        editor.transaction({
            changes: changes
        });
    }
};
const updateTableOfContents = (viewInfo, settings) => {
    var _a;
    if (!viewInfo)
        return;
    const headings = (_a = viewInfo.data.headings) !== null && _a !== void 0 ? _a : [];
    const editor = viewInfo.editor;
    if (!doesContentsHaveValue(settings.contents))
        return;
    let tocHeading;
    let tocBuilder = '\n';
    const changes = [];
    // In case headings start above level 1, we don't want to indent the bullets too much
    let initialHeadingLevel = 1;
    if (headings.length > 0) {
        initialHeadingLevel = headings[0].level;
    }
    for (const heading of headings) {
        // ORDERING: Important to find the TOC heading before skipping skipped headings, since that is for numbering
        // Find the TOC heading
        if (heading.heading.endsWith(settings.contents)) {
            tocHeading = heading;
        }
        /* This code lets us skip TOC lines for skipped headings, but doesn't work well with first-level setting
        if ((settings.skipTopLevel && heading.level === 1) || (heading.level > settings.maxLevel)) {
          continue
        }
        */
        const tocEntry = createTocEntry(heading, settings, initialHeadingLevel);
        tocBuilder += tocEntry + '\n';
    }
    // Insert the generated table of contents
    if (tocHeading) {
        const from = {
            line: tocHeading.position.start.line + 1,
            ch: 0
        };
        const startingLine = tocHeading.position.start.line + 1;
        let endingLine = 0;
        let foundList = false;
        for (endingLine = startingLine;; endingLine++) {
            const line = editor.getLine(endingLine);
            if (line === undefined) {
                // Reached end of file, insert at the start of the TOC section
                endingLine = startingLine;
                break;
            }
            const trimmedLineText = line.trimStart();
            if (foundList) {
                if (!trimmedLineText.startsWith(TOC_LIST_ITEM_BULLET))
                    break;
                if (trimmedLineText.startsWith('#'))
                    break;
            }
            else {
                if (trimmedLineText.startsWith(TOC_LIST_ITEM_BULLET)) {
                    foundList = true;
                }
                else if (trimmedLineText.startsWith('#')) {
                    // Reached the next heading without finding existing TOC list, insert at the start of the TOC section
                    endingLine = startingLine;
                    break;
                }
                else {
                    continue;
                }
            }
        }
        if (tocBuilder === '\n') {
            tocBuilder = '';
        }
        const to = {
            line: endingLine,
            ch: 0
        };
        const range = { from, to };
        replaceRangeSafely(editor, changes, range, tocBuilder);
    }
    // Execute the transaction to make all the changes at once
    if (changes.length > 0) {
        // eslint-disable-next-line no-console
        console.log('Number Headings Plugin: Applying table of contents changes:', changes.length);
        editor.transaction({
            changes: changes
        });
    }
};
const removeHeadingNumbering = (viewInfo) => {
    var _a;
    if (!viewInfo)
        return;
    const headings = (_a = viewInfo.data.headings) !== null && _a !== void 0 ? _a : [];
    const editor = viewInfo.editor;
    const changes = [];
    for (const heading of headings) {
        const prefixRange = getHeadingPrefixRange(editor, heading);
        if (prefixRange === undefined)
            return;
        const headingHashString = makeHeadingHashString(editor, heading);
        if (headingHashString === undefined)
            return;
        replaceRangeSafely(editor, changes, prefixRange, headingHashString + ' ');
    }
    if (changes.length > 0) {
        editor.transaction({
            changes: changes
        });
    }
};

class NumberHeadingsPluginSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.plugin = plugin;
    }
    display() {
        const { containerEl } = this;
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Number Headings - Settings' });
        containerEl.createEl('div', { text: 'To add numbering to your document, bring up the command window (on Mac, type CMD+P), and then type "Number Headings" to see a list of available commands.' });
        containerEl.createEl('br', {});
        containerEl.createEl('div', { text: 'If the document has front matter defined with the below settings, the project-wide settings defined on this screen will be ignored. You can define front matter like this:' });
        containerEl.createEl('pre', {
            text: `    ---
    alias:
    - Example Alias
    tags:
    - example-tag
    number headings: first-level 1, max 6, 1.1, auto, contents ^toc
    ---`
        });
        containerEl.createEl('div', {
            text: `
      The 'number headings' front matter key is used to store numbering settings specific to the file. There are four possible options
      in the value to the right of the colon, separated by commas.
    `
        });
        const ul = containerEl.createEl('ul', {});
        const li0 = ul.createEl('li', {});
        li0.createEl('b', { text: 'Automatic numbering' });
        li0.createEl('span', { text: ': If \'auto\' appears, the document will be automatically numbered.' });
        const li1 = ul.createEl('li', {});
        li1.createEl('b', { text: 'First level to number' });
        li1.createEl('span', { text: ': If \'first-level 2\' appears, the numbering will start at the second level' });
        const li2 = ul.createEl('li', {});
        li2.createEl('b', { text: 'Maximum level to number' });
        li2.createEl('span', { text: ': If \'max 6\' appears, the headings above level 6 will be skipped.' });
        const li3 = ul.createEl('li', {});
        li3.createEl('b', { text: 'Table of contents anchor' });
        li3.createEl('span', { text: ': If \'contents ^toc\' appears, the heading that ends with the anchor ^toc will have a table of contents inserted beneath it.' });
        const li4 = ul.createEl('li', {});
        li4.createEl('b', { text: 'Numbering style' });
        li4.createEl('span', {
            text: `:
      A style text like '1.1', 'A.1', or '_.1.1' tells the plugin how to format the headings.
      If a style string ends with '.' (a dot), ':' (a colon), or '-' (a dash), the heading numbers will be separated from the heading title
      with that symbol.`
        });
        const ul3 = li4.createEl('ul', {});
        ul3.createEl('li', {
            text: `      
      For example, '1.1' means both top level and other headings will be numbered starting from '1'.
    `
        });
        ul3.createEl('li', {
            text: `      
      For example, 'A.1' means top level headings will be numbered starting from 'A'.
    `
        });
        ul3.createEl('li', {
            text: `      
      For example, '_.A.1' means top level headings will NOT be numbered, but the next levels will be numbered with letters and numbers.
    `
        });
        ul3.createEl('li', {
            text: `      
      For example, '1.1:' means headings will look like '## 2.4: Example Heading'
    `
        });
        ul3.createEl('li', {
            text: `      
      For example, 'A.1-' means headings will look like '## B.5- Example Heading'
    `
        });
        new obsidian.Setting(containerEl)
            .setName('Skip top heading level')
            .setDesc('If selected, numbering will not be applied to the top heading level.')
            .addToggle(toggle => toggle
            .setValue(this.plugin.settings.skipTopLevel)
            .setTooltip('Skip top heading level')
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.skipTopLevel = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('First heading level')
            .setDesc('First heading level to number.')
            .addSlider(slider => slider
            .setLimits(1, 6, 1)
            .setValue(this.plugin.settings.firstLevel)
            .setDynamicTooltip()
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.firstLevel = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Maximum heading level')
            .setDesc('Maximum heading level to number.')
            .addSlider(slider => slider
            .setLimits(1, 6, 1)
            .setValue(this.plugin.settings.maxLevel)
            .setDynamicTooltip()
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.maxLevel = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Style for level 1 headings')
            .setDesc('Defines the numbering style for level one headings. Valid values are 1 (for numbers) or A (for capital letters).')
            .addText(text => text
            .setValue(this.plugin.settings.styleLevel1)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.styleLevel1 = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Style for lower level headings (below level 1)')
            .setDesc('Defines the numbering style for headings below level one. Valid values are 1 (for numbers) or A (for capital letters).')
            .addText(text => text
            .setValue(this.plugin.settings.styleLevelOther)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.styleLevelOther = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Automatic numbering')
            .setDesc('Turns on automatic numbering of documents.')
            .addToggle(toggle => toggle
            .setValue(this.plugin.settings.auto)
            .setTooltip('Turn on automatic numbering')
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.auto = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Separator style')
            .setDesc('Defines the separator style between the heading number and the heading text. Valid values are : (colon) or . (dot) or - (dash). You can also leave it blank for no separator.')
            .addText(text => text
            .setValue(this.plugin.settings.separator)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.separator = value;
            yield this.plugin.saveSettings();
        })));
        new obsidian.Setting(containerEl)
            .setName('Table of Contents Anchor')
            .setDesc('Anchor which labels the header where a table of contents should be inserted. The anchor should be added at the end of a header. For example, ^toc.')
            .addText(text => text
            .setValue(this.plugin.settings.contents)
            .onChange((value) => __awaiter(this, void 0, void 0, function* () {
            this.plugin.settings.contents = value;
            yield this.plugin.saveSettings();
        })));
    }
}
class NumberHeadingsPlugin extends obsidian.Plugin {
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            // eslint-disable-next-line no-console
            console.info('Loading Number Headings Plugin, version ' + this.manifest.version);
            yield this.loadSettings();
            this.addCommand({
                id: 'number-headings-with-options',
                name: 'Number all headings in document (and show options)',
                checkCallback: (checking) => {
                    if (checking)
                        return isViewActive(this.app);
                    const viewInfo = getViewInfo(this.app);
                    if (viewInfo) {
                        const settings = getFrontMatterSettingsOrAlternative(viewInfo.data, this.settings);
                        updateHeadingNumbering(viewInfo, settings);
                        setTimeout(() => {
                            // HACK: This must happen after a timeout so that there is time for the editor transaction to complete
                            const postNumberingViewInfo = getViewInfo(this.app);
                            updateTableOfContents(postNumberingViewInfo, settings);
                        }, 3000);
                        showNumberingDoneMessage(this.app, settings, viewInfo);
                    }
                    return false;
                }
            });
            this.addCommand({
                id: 'number-headings',
                name: 'Number all headings in document',
                checkCallback: (checking) => {
                    if (checking)
                        return isViewActive(this.app);
                    const viewInfo = getViewInfo(this.app);
                    if (viewInfo) {
                        const settings = getFrontMatterSettingsOrAlternative(viewInfo.data, this.settings);
                        updateHeadingNumbering(viewInfo, settings);
                        setTimeout(() => {
                            // HACK: This must happen after a timeout so that there is time for the editor transaction to complete
                            const postNumberingViewInfo = getViewInfo(this.app);
                            updateTableOfContents(postNumberingViewInfo, settings);
                        }, 3000);
                        // NOTE: The line below is intentionally commented out, since this command is the same as
                        //       the above command, except for this line
                        // showNumberingDoneMessage(this.app, settings, viewInfo)
                    }
                    return false;
                }
            });
            this.addCommand({
                id: 'remove-number-headings',
                name: 'Remove numbering from all headings in document',
                checkCallback: (checking) => {
                    if (checking)
                        return isViewActive(this.app);
                    const viewInfo = getViewInfo(this.app);
                    removeHeadingNumbering(viewInfo);
                    return true;
                }
            });
            this.addCommand({
                id: 'save-settings-to-front-matter',
                name: 'Save settings to front matter',
                checkCallback: (checking) => {
                    if (checking)
                        return isViewActive(this.app);
                    const viewInfo = getViewInfo(this.app);
                    if (viewInfo) {
                        const settings = getFrontMatterSettingsOrAlternative(viewInfo.data, this.settings);
                        saveSettingsToFrontMatter(viewInfo.data, viewInfo.editor, settings);
                    }
                    return false;
                }
            });
            this.addSettingTab(new NumberHeadingsPluginSettingTab(this.app, this));
            this.registerInterval(window.setInterval(() => {
                const viewInfo = getViewInfo(this.app);
                if (viewInfo) {
                    const settings = getFrontMatterSettingsOrAlternative(viewInfo.data, this.settings);
                    if (settings.auto) {
                        updateHeadingNumbering(viewInfo, settings);
                        setTimeout(() => {
                            // HACK: This must happen after a timeout so that there is time for the editor transaction to complete
                            const postNumberingViewInfo = getViewInfo(this.app);
                            updateTableOfContents(postNumberingViewInfo, settings);
                        }, 3000);
                        // eslint-disable-next-line no-console
                        console.log('Number Headings Plugin: Automatically numbered document');
                    }
                }
            }, 10 * 1000));
        });
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
}

module.exports = NumberHeadingsPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsInNyYy9hY3RpdmVWaWV3SGVscGVycy50cyIsInNyYy9zZXR0aW5nc1R5cGVzLnRzIiwic3JjL2Zyb250TWF0dGVyLnRzIiwic3JjL21lc3NhZ2VzLnRzIiwic3JjL251bWJlcmluZy50cyIsInNyYy9tYWluLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2NyZWF0ZUJpbmRpbmcgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xyXG4gICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcclxuICAgICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcclxufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBvW2syXSA9IG1ba107XHJcbn0pO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBvKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIHApKSBfX2NyZWF0ZUJpbmRpbmcobywgbSwgcCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/IFwiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIiA6IFwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheXMoKSB7XHJcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcclxuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcclxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcclxuICAgICAgICAgICAgcltrXSA9IGFbal07XHJcbiAgICByZXR1cm4gcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXkodG8sIGZyb20sIHBhY2spIHtcclxuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xyXG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xyXG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcclxufSkgOiBmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcclxuICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRHZXQocmVjZWl2ZXIsIHN0YXRlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBnZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCByZWFkIHByaXZhdGUgbWVtYmVyIGZyb20gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiBraW5kID09PSBcIm1cIiA/IGYgOiBraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlcikgOiBmID8gZi52YWx1ZSA6IHN0YXRlLmdldChyZWNlaXZlcik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBzdGF0ZSwgdmFsdWUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcIm1cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgbWV0aG9kIGlzIG5vdCB3cml0YWJsZVwiKTtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIHNldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHdyaXRlIHByaXZhdGUgbWVtYmVyIHRvIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4gKGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyLCB2YWx1ZSkgOiBmID8gZi52YWx1ZSA9IHZhbHVlIDogc3RhdGUuc2V0KHJlY2VpdmVyLCB2YWx1ZSkpLCB2YWx1ZTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRJbihzdGF0ZSwgcmVjZWl2ZXIpIHtcclxuICAgIGlmIChyZWNlaXZlciA9PT0gbnVsbCB8fCAodHlwZW9mIHJlY2VpdmVyICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiByZWNlaXZlciAhPT0gXCJmdW5jdGlvblwiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCB1c2UgJ2luJyBvcGVyYXRvciBvbiBub24tb2JqZWN0XCIpO1xyXG4gICAgcmV0dXJuIHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgPT09IHN0YXRlIDogc3RhdGUuaGFzKHJlY2VpdmVyKTtcclxufVxyXG4iLCJpbXBvcnQgeyBBcHAsIENhY2hlZE1ldGFkYXRhLCBFZGl0b3IsIE1hcmtkb3duVmlldyB9IGZyb20gJ29ic2lkaWFuJ1xuXG5mdW5jdGlvbiBnZXRBY3RpdmVWaWV3IChhcHA6IEFwcCk6IE1hcmtkb3duVmlldyB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IGFjdGl2ZVZpZXcgPSBhcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuICByZXR1cm4gYWN0aXZlVmlldyA/PyB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmlld0FjdGl2ZSAoYXBwOiBBcHApOiBib29sZWFuIHtcbiAgY29uc3QgYWN0aXZlVmlldyA9IGdldEFjdGl2ZVZpZXcoYXBwKVxuICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUpIHJldHVybiB0cnVlXG4gIHJldHVybiBmYWxzZVxufVxuXG5mdW5jdGlvbiBnZXRWaWV3TWV0YWRhdGEgKGFwcDogQXBwKTogQ2FjaGVkTWV0YWRhdGEgfCB1bmRlZmluZWQge1xuICBjb25zdCBhY3RpdmVWaWV3ID0gZ2V0QWN0aXZlVmlldyhhcHApXG4gIGlmIChhY3RpdmVWaWV3ICYmIGFjdGl2ZVZpZXcuZmlsZSkge1xuICAgIGNvbnN0IGRhdGEgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoYWN0aXZlVmlldy5maWxlKSB8fCB7fVxuICAgIHJldHVybiBkYXRhXG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZpZXdJbmZvIHtcbiAgYWN0aXZlVmlldzogTWFya2Rvd25WaWV3XG4gIGRhdGE6IENhY2hlZE1ldGFkYXRhXG4gIGVkaXRvcjogRWRpdG9yXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRWaWV3SW5mbyAoYXBwOiBBcHApOiBWaWV3SW5mbyB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IGFjdGl2ZVZpZXcgPSBnZXRBY3RpdmVWaWV3KGFwcClcbiAgY29uc3QgZGF0YSA9IGdldFZpZXdNZXRhZGF0YShhcHApXG4gIGNvbnN0IGVkaXRvciA9IGFjdGl2ZVZpZXcgPyBhY3RpdmVWaWV3LmVkaXRvciA6IHVuZGVmaW5lZFxuXG4gIGlmIChhY3RpdmVWaWV3ICYmIGRhdGEgJiYgZWRpdG9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFjdGl2ZVZpZXcsIGRhdGEsIGVkaXRvclxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB1bmRlZmluZWRcbn1cbiIsImV4cG9ydCBpbnRlcmZhY2UgTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5ncyB7XG4gIHNraXBUb3BMZXZlbDogYm9vbGVhbixcbiAgZmlyc3RMZXZlbDogbnVtYmVyLFxuICBtYXhMZXZlbDogbnVtYmVyLFxuICBzdHlsZUxldmVsMTogc3RyaW5nLFxuICBzdHlsZUxldmVsT3RoZXI6IHN0cmluZyxcbiAgYXV0bzogYm9vbGVhbixcbiAgc2VwYXJhdG9yOiBzdHJpbmcsXG4gIGNvbnRlbnRzOiBzdHJpbmdcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MgPSB7XG4gIHNraXBUb3BMZXZlbDogZmFsc2UsXG4gIGZpcnN0TGV2ZWw6IDEsXG4gIG1heExldmVsOiA2LFxuICBzdHlsZUxldmVsMTogJzEnLFxuICBzdHlsZUxldmVsT3RoZXI6ICcxJyxcbiAgYXV0bzogZmFsc2UsXG4gIHNlcGFyYXRvcjogJycsXG4gIGNvbnRlbnRzOiAnJ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZExldmVsU3R5bGUgKHM6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBpZiAocyA9PT0gJ0EnIHx8IHMgPT09ICcxJykgcmV0dXJuIHRydWVcbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkRmxhZyAoZjogdW5rbm93bik6IGJvb2xlYW4ge1xuICBpZiAoZiA9PT0gdHJ1ZSB8fCBmID09PSBmYWxzZSkgcmV0dXJuIHRydWVcbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkRmlyc3RPck1heExldmVsICh4OiB1bmtub3duKTogYm9vbGVhbiB7XG4gIGlmICh0eXBlb2YgeCA9PT0gJ251bWJlcicgJiYgeCA+PSAxICYmIHggPD0gNikgcmV0dXJuIHRydWVcbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkU2VwYXJhdG9yICh4OiB1bmtub3duKTogYm9vbGVhbiB7XG4gIGlmICh0eXBlb2YgeCA9PT0gJ3N0cmluZycgJiYgKHggPT09ICcnIHx8IHggPT09ICc6JyB8fCB4ID09PSAnLicgfHwgeCA9PT0gJy0nKSkgcmV0dXJuIHRydWVcbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkQ29udGVudHMgKHg6IHVua25vd24pOiBib29sZWFuIHtcbiAgaWYgKHR5cGVvZiB4ID09PSAnc3RyaW5nJyAmJiAoeCA9PT0gJycgfHwgeC5zdGFydHNXaXRoKCdeJykpKSByZXR1cm4gdHJ1ZVxuICByZXR1cm4gZmFsc2Vcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRvZXNDb250ZW50c0hhdmVWYWx1ZSAoeDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGlmICh4Lmxlbmd0aCA+IDIgJiYgeC5zdGFydHNXaXRoKCdeJykpIHJldHVybiB0cnVlXG4gIHJldHVybiBmYWxzZVxufVxuIiwiaW1wb3J0IHsgQ2FjaGVkTWV0YWRhdGEsIEVkaXRvciwgRWRpdG9yUG9zaXRpb24sIEZyb250TWF0dGVyQ2FjaGUsIHBhcnNlRnJvbnRNYXR0ZXJFbnRyeSB9IGZyb20gJ29ic2lkaWFuJ1xuaW1wb3J0IHsgREVGQVVMVF9TRVRUSU5HUywgaXNWYWxpZENvbnRlbnRzLCBpc1ZhbGlkRmlyc3RPck1heExldmVsLCBpc1ZhbGlkRmxhZywgaXNWYWxpZExldmVsU3R5bGUsIGlzVmFsaWRTZXBhcmF0b3IsIE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuL3NldHRpbmdzVHlwZXMnXG5cbmNvbnN0IEFVVE9fUEFSVF9LRVkgPSAnYXV0bydcbmNvbnN0IEZJUlNUX0xFVkVMX1BBUlRfS0VZID0gJ2ZpcnN0LWxldmVsJ1xuY29uc3QgTUFYX0xFVkVMX1BBUlRfS0VZID0gJ21heCdcbmNvbnN0IENPTlRFTlRTX1BBUlRfS0VZID0gJ2NvbnRlbnRzJ1xuXG5mdW5jdGlvbiBwYXJzZUNvbXBhY3RGcm9udE1hdHRlclNldHRpbmdzIChmbTogRnJvbnRNYXR0ZXJDYWNoZSk6IE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MgfCB1bmRlZmluZWQge1xuICBjb25zdCBlbnRyeSA9IHBhcnNlRnJvbnRNYXR0ZXJFbnRyeShmbSwgJ251bWJlciBoZWFkaW5ncycpXG4gIGlmIChlbnRyeSkge1xuICAgIGNvbnN0IGVudHJ5U3RyaW5nID0gU3RyaW5nKGVudHJ5KVxuICAgIGNvbnN0IHBhcnRzID0gZW50cnlTdHJpbmcuc3BsaXQoJywnKVxuICAgIGNvbnN0IHNldHRpbmdzOiBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdzID0geyAuLi5ERUZBVUxUX1NFVFRJTkdTIH1cblxuICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0cykge1xuICAgICAgY29uc3QgY2xlYW5QYXJ0ID0gcGFydC50cmltKClcbiAgICAgIGlmIChjbGVhblBhcnQubGVuZ3RoID09PSAwKSBjb250aW51ZVxuXG4gICAgICBpZiAoY2xlYW5QYXJ0ID09PSBBVVRPX1BBUlRfS0VZKSB7XG4gICAgICAgIC8vIFBhcnNlIGF1dG8gbnVtYmVyaW5nIHBhcnRcbiAgICAgICAgc2V0dGluZ3MuYXV0byA9IHRydWVcbiAgICAgIH0gZWxzZSBpZiAoY2xlYW5QYXJ0LnN0YXJ0c1dpdGgoRklSU1RfTEVWRUxfUEFSVF9LRVkpKSB7XG4gICAgICAgIC8vIFBhcnNlIGZpcnN0IGxldmVsIHBhcnRcbiAgICAgICAgY29uc3QgbnN0cmluZyA9IGNsZWFuUGFydC5zdWJzdHJpbmcoRklSU1RfTEVWRUxfUEFSVF9LRVkubGVuZ3RoICsgMSlcbiAgICAgICAgY29uc3QgbiA9IHBhcnNlSW50KG5zdHJpbmcpXG4gICAgICAgIGlmIChpc1ZhbGlkRmlyc3RPck1heExldmVsKG4pKSB7XG4gICAgICAgICAgc2V0dGluZ3MuZmlyc3RMZXZlbCA9IG5cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjbGVhblBhcnQuc3RhcnRzV2l0aChNQVhfTEVWRUxfUEFSVF9LRVkpKSB7XG4gICAgICAgIC8vIFBhcnNlIG1heCBsZXZlbCBwYXJ0XG4gICAgICAgIGNvbnN0IG5zdHJpbmcgPSBjbGVhblBhcnQuc3Vic3RyaW5nKE1BWF9MRVZFTF9QQVJUX0tFWS5sZW5ndGggKyAxKVxuICAgICAgICBjb25zdCBuID0gcGFyc2VJbnQobnN0cmluZylcbiAgICAgICAgaWYgKGlzVmFsaWRGaXJzdE9yTWF4TGV2ZWwobikpIHtcbiAgICAgICAgICBzZXR0aW5ncy5tYXhMZXZlbCA9IG5cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChjbGVhblBhcnQuc3RhcnRzV2l0aChDT05URU5UU19QQVJUX0tFWSkpIHtcbiAgICAgICAgaWYgKGNsZWFuUGFydC5sZW5ndGggPD0gQ09OVEVOVFNfUEFSVF9LRVkubGVuZ3RoICsgMSkgY29udGludWVcbiAgICAgICAgLy8gUGFyc2UgY29udGVudHMgaGVhZGluZyBwYXJ0XG4gICAgICAgIGNvbnN0IHRvY0hlYWRpbmcgPSBjbGVhblBhcnQuc3Vic3RyaW5nKENPTlRFTlRTX1BBUlRfS0VZLmxlbmd0aCArIDEpXG4gICAgICAgIGlmIChpc1ZhbGlkQ29udGVudHModG9jSGVhZGluZykpIHtcbiAgICAgICAgICBzZXR0aW5ncy5jb250ZW50cyA9IHRvY0hlYWRpbmdcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gUGFyc2UgZm9ybWF0dGluZyBwYXJ0XG4gICAgICAgIGNvbnN0IGxhc3RDaGFyID0gY2xlYW5QYXJ0W2NsZWFuUGFydC5sZW5ndGggLSAxXVxuICAgICAgICBsZXQgcmVtYWluaW5nUGFydCA9IGNsZWFuUGFydFxuICAgICAgICBpZiAoaXNWYWxpZFNlcGFyYXRvcihsYXN0Q2hhcikpIHtcbiAgICAgICAgICBzZXR0aW5ncy5zZXBhcmF0b3IgPSBsYXN0Q2hhclxuICAgICAgICAgIHJlbWFpbmluZ1BhcnQgPSBjbGVhblBhcnQuc3Vic3RyaW5nKDAsIGNsZWFuUGFydC5sZW5ndGggLSAxKVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0b3JzID0gcmVtYWluaW5nUGFydC5zcGxpdCgnLicpXG4gICAgICAgIGxldCBmaXJzdE51bWJlcmVkRGVzY3JpcHRvciA9IDBcbiAgICAgICAgaWYgKGRlc2NyaXB0b3JzLmxlbmd0aCA+IDEgJiYgZGVzY3JpcHRvcnNbMF0gPT09ICdfJykge1xuICAgICAgICAgIHNldHRpbmdzLnNraXBUb3BMZXZlbCA9IHRydWVcbiAgICAgICAgICBmaXJzdE51bWJlcmVkRGVzY3JpcHRvciA9IDFcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZXR0aW5ncy5za2lwVG9wTGV2ZWwgPSBmYWxzZVxuICAgICAgICB9XG4gICAgICAgIGlmIChkZXNjcmlwdG9ycy5sZW5ndGggLSBmaXJzdE51bWJlcmVkRGVzY3JpcHRvciA+PSAyKSB7XG4gICAgICAgICAgY29uc3Qgc3R5bGVMZXZlbDEgPSBkZXNjcmlwdG9yc1tmaXJzdE51bWJlcmVkRGVzY3JpcHRvcl1cbiAgICAgICAgICBpZiAoaXNWYWxpZExldmVsU3R5bGUoc3R5bGVMZXZlbDEpKSB7XG4gICAgICAgICAgICBzZXR0aW5ncy5zdHlsZUxldmVsMSA9IHN0eWxlTGV2ZWwxXG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHN0eWxlTGV2ZWxPdGhlciA9IGRlc2NyaXB0b3JzW2ZpcnN0TnVtYmVyZWREZXNjcmlwdG9yICsgMV1cbiAgICAgICAgICBpZiAoaXNWYWxpZExldmVsU3R5bGUoc3R5bGVMZXZlbE90aGVyKSkge1xuICAgICAgICAgICAgc2V0dGluZ3Muc3R5bGVMZXZlbE90aGVyID0gc3R5bGVMZXZlbE90aGVyXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHNldHRpbmdzXG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBjb25zdCBnZXRGcm9udE1hdHRlclNldHRpbmdzT3JBbHRlcm5hdGl2ZSA9IChcbiAgeyBmcm9udG1hdHRlciB9OiBDYWNoZWRNZXRhZGF0YSxcbiAgYWx0ZXJuYXRpdmVTZXR0aW5nczogTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5nc1xuKTogTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5ncyA9PiB7XG4gIGlmIChmcm9udG1hdHRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgZGVjb21wYWN0ZWRTZXR0aW5ncyA9IHBhcnNlQ29tcGFjdEZyb250TWF0dGVyU2V0dGluZ3MoZnJvbnRtYXR0ZXIpXG4gICAgaWYgKGRlY29tcGFjdGVkU2V0dGluZ3MgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGRlY29tcGFjdGVkU2V0dGluZ3NcblxuICAgIC8vIE5PVEU6IEV2ZXJ5dGhpbmcgYmVsb3cgaXMgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IG9ubHlcblxuICAgIGNvbnN0IHNraXBUb3BMZXZlbEVudHJ5ID0gcGFyc2VGcm9udE1hdHRlckVudHJ5KGZyb250bWF0dGVyLCAnbnVtYmVyLWhlYWRpbmdzLXNraXAtdG9wLWxldmVsJykgPz8gcGFyc2VGcm9udE1hdHRlckVudHJ5KGZyb250bWF0dGVyLCAnaGVhZGVyLW51bWJlcmluZy1za2lwLXRvcC1sZXZlbCcpXG4gICAgY29uc3Qgc2tpcFRvcExldmVsID0gaXNWYWxpZEZsYWcoc2tpcFRvcExldmVsRW50cnkpID8gc2tpcFRvcExldmVsRW50cnkgOiBhbHRlcm5hdGl2ZVNldHRpbmdzLnNraXBUb3BMZXZlbFxuXG4gICAgY29uc3QgbWF4TGV2ZWxFbnRyeSA9IHBhcnNlRnJvbnRNYXR0ZXJFbnRyeShmcm9udG1hdHRlciwgJ251bWJlci1oZWFkaW5ncy1tYXgtbGV2ZWwnKSA/PyBwYXJzZUZyb250TWF0dGVyRW50cnkoZnJvbnRtYXR0ZXIsICdoZWFkZXItbnVtYmVyaW5nLW1heC1sZXZlbCcpXG4gICAgY29uc3QgbWF4TGV2ZWwgPSBpc1ZhbGlkRmlyc3RPck1heExldmVsKG1heExldmVsRW50cnkpID8gbWF4TGV2ZWxFbnRyeSA6IGFsdGVybmF0aXZlU2V0dGluZ3MubWF4TGV2ZWxcblxuICAgIGNvbnN0IHN0eWxlTGV2ZWwxRW50cnkgPSBTdHJpbmcoXG4gICAgICBwYXJzZUZyb250TWF0dGVyRW50cnkoZnJvbnRtYXR0ZXIsICdudW1iZXItaGVhZGluZ3Mtc3R5bGUtbGV2ZWwtMScpID8/XG4gICAgICBwYXJzZUZyb250TWF0dGVyRW50cnkoZnJvbnRtYXR0ZXIsICdoZWFkZXItbnVtYmVyaW5nLXN0eWxlLWxldmVsLTEnKVxuICAgIClcbiAgICBjb25zdCBzdHlsZUxldmVsMSA9IGlzVmFsaWRMZXZlbFN0eWxlKHN0eWxlTGV2ZWwxRW50cnkpID8gc3R5bGVMZXZlbDFFbnRyeSA6IGFsdGVybmF0aXZlU2V0dGluZ3Muc3R5bGVMZXZlbDFcblxuICAgIGNvbnN0IHN0eWxlTGV2ZWxPdGhlckVudHJ5ID0gU3RyaW5nKFxuICAgICAgcGFyc2VGcm9udE1hdHRlckVudHJ5KGZyb250bWF0dGVyLCAnbnVtYmVyLWhlYWRpbmdzLXN0eWxlLWxldmVsLW90aGVyJykgPz9cbiAgICAgIHBhcnNlRnJvbnRNYXR0ZXJFbnRyeShmcm9udG1hdHRlciwgJ2hlYWRlci1udW1iZXJpbmctc3R5bGUtbGV2ZWwtb3RoZXInKVxuICAgIClcbiAgICBjb25zdCBzdHlsZUxldmVsT3RoZXIgPSBpc1ZhbGlkTGV2ZWxTdHlsZShzdHlsZUxldmVsT3RoZXJFbnRyeSkgPyBzdHlsZUxldmVsT3RoZXJFbnRyeSA6IGFsdGVybmF0aXZlU2V0dGluZ3Muc3R5bGVMZXZlbE90aGVyXG5cbiAgICBjb25zdCBhdXRvRW50cnkgPSBwYXJzZUZyb250TWF0dGVyRW50cnkoZnJvbnRtYXR0ZXIsICdudW1iZXItaGVhZGluZ3MtYXV0bycpID8/IHBhcnNlRnJvbnRNYXR0ZXJFbnRyeShmcm9udG1hdHRlciwgJ2hlYWRlci1udW1iZXJpbmctYXV0bycpXG4gICAgY29uc3QgYXV0byA9IGlzVmFsaWRGbGFnKGF1dG9FbnRyeSkgPyBhdXRvRW50cnkgOiBhbHRlcm5hdGl2ZVNldHRpbmdzLmF1dG9cblxuICAgIHJldHVybiB7IC4uLmFsdGVybmF0aXZlU2V0dGluZ3MsIHNraXBUb3BMZXZlbCwgbWF4TGV2ZWwsIHN0eWxlTGV2ZWwxLCBzdHlsZUxldmVsT3RoZXIsIGF1dG8gfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBhbHRlcm5hdGl2ZVNldHRpbmdzXG4gIH1cbn1cblxuZnVuY3Rpb24gc2V0dGluZ3NUb0NvbXBhY3RGcm9udE1hdHRlclZhbHVlIChzZXR0aW5nczogTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5ncyk6IHN0cmluZyB7XG4gIGNvbnN0IGF1dG9QYXJ0ID0gc2V0dGluZ3MuYXV0byA/ICdhdXRvLCAnIDogJydcbiAgY29uc3QgZmlyc3RMZXZlbFBhcnQgPSBgZmlyc3QtbGV2ZWwgJHtzZXR0aW5ncy5maXJzdExldmVsfSwgYFxuICBjb25zdCBtYXhQYXJ0ID0gYG1heCAke3NldHRpbmdzLm1heExldmVsfSwgYFxuICBjb25zdCBjb250ZW50c1BhcnQgPSBzZXR0aW5ncy5jb250ZW50cyAmJiBzZXR0aW5ncy5jb250ZW50cy5sZW5ndGggPiAwID8gYGNvbnRlbnRzICR7c2V0dGluZ3MuY29udGVudHN9LCBgIDogJydcbiAgY29uc3Qgc2tpcFRvcExldmVsU3RyaW5nID0gc2V0dGluZ3Muc2tpcFRvcExldmVsID8gJ18uJyA6ICcnXG4gIGNvbnN0IHN0eWxlUGFydCA9IGAke3NraXBUb3BMZXZlbFN0cmluZ30ke3NldHRpbmdzLnN0eWxlTGV2ZWwxfS4ke3NldHRpbmdzLnN0eWxlTGV2ZWxPdGhlcn0ke3NldHRpbmdzLnNlcGFyYXRvcn1gXG4gIHJldHVybiBhdXRvUGFydCArIGZpcnN0TGV2ZWxQYXJ0ICsgbWF4UGFydCArIGNvbnRlbnRzUGFydCArIHN0eWxlUGFydFxufVxuXG5mdW5jdGlvbiBmaW5kTGluZVdoaWNoU3RhcnRzV2l0aCAoZWRpdG9yOiBFZGl0b3IsIHNlYXJjaDogc3RyaW5nLCBhZnRlckxpbmU6IG51bWJlcik6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gIC8vIEZpbmQgdGhlIGxvY2F0aW9uIG9mIHRoZSBmcm9udG1hdHRlclxuICBmb3IgKGxldCBpID0gYWZ0ZXJMaW5lOyBpIDwgZWRpdG9yLmxhc3RMaW5lKCk7IGkrKykge1xuICAgIGNvbnN0IGxpbmVTdHJpbmcgPSBlZGl0b3IuZ2V0TGluZShpKVxuICAgIGlmIChsaW5lU3RyaW5nLnN0YXJ0c1dpdGgoc2VhcmNoKSkge1xuICAgICAgcmV0dXJuIGlcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZFxufVxuXG5leHBvcnQgY29uc3Qgc2F2ZVNldHRpbmdzVG9Gcm9udE1hdHRlciA9IChcbiAgeyBmcm9udG1hdHRlciB9OiBDYWNoZWRNZXRhZGF0YSxcbiAgZWRpdG9yOiBFZGl0b3IsXG4gIHNldHRpbmdzOiBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdzXG4pOiB2b2lkID0+IHtcbiAgaWYgKGZyb250bWF0dGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBGcm9udCBtYXR0ZXIgYWxyZWFkeSBleGlzdHMsIHNvIHdlJ2xsIG5lZWQgdG8gaW5zZXJ0IHRoZSBzZXR0aW5ncyBpbnRvIHRoZSBmcm9udCBtYXR0ZXJcblxuICAgIGNvbnN0IGZyb250TWF0dGVyTGluZSA9IGZyb250bWF0dGVyLnBvc2l0aW9uLnN0YXJ0LmxpbmVcbiAgICBjb25zdCB2ID0gc2V0dGluZ3NUb0NvbXBhY3RGcm9udE1hdHRlclZhbHVlKHNldHRpbmdzKVxuICAgIGNvbnN0IGZyb250TWF0dGVyQWRkaXRpb25zID0gYG51bWJlciBoZWFkaW5nczogJHt2fVxcbmBcblxuICAgIGlmIChmcm9udG1hdHRlclsnbnVtYmVyIGhlYWRpbmdzJ10gIT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gS2V5IGFscmVhZHkgcHJlc2VudCwgcmVwbGFjZSBpdFxuICAgICAgY29uc3Qga2V5TGluZSA9IGZpbmRMaW5lV2hpY2hTdGFydHNXaXRoKGVkaXRvciwgJ251bWJlciBoZWFkaW5ncycsIGZyb250TWF0dGVyTGluZSlcbiAgICAgIGlmIChrZXlMaW5lID09PSB1bmRlZmluZWQpIHRocm93IG5ldyBFcnJvcignTnVtYmVyIEhlYWRpbmdzIFBsdWdpbjogXCJudW1iZXIgaGVhZGluZ3NcIiBrZXkgZXhpc3RzIGJ1dCBub3QgZm91bmQuJylcbiAgICAgIGNvbnN0IGZyb206IEVkaXRvclBvc2l0aW9uID0geyBsaW5lOiBrZXlMaW5lLCBjaDogMCB9XG4gICAgICBjb25zdCB0bzogRWRpdG9yUG9zaXRpb24gPSB7IGxpbmU6IGtleUxpbmUgKyAxLCBjaDogMCB9XG4gICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGZyb250TWF0dGVyQWRkaXRpb25zLCBmcm9tLCB0bylcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gS2V5IG5vdCBwcmVzZW50LCBpbnNlcnQgbmV3IGtleVxuICAgICAgY29uc3QgZnJvbTogRWRpdG9yUG9zaXRpb24gPSB7IGxpbmU6IGZyb250TWF0dGVyTGluZSArIDEsIGNoOiAwIH1cbiAgICAgIGNvbnN0IHRvOiBFZGl0b3JQb3NpdGlvbiA9IHsgbGluZTogZnJvbnRNYXR0ZXJMaW5lICsgMSwgY2g6IDAgfVxuICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShmcm9udE1hdHRlckFkZGl0aW9ucywgZnJvbSwgdG8pXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIE5vIGZyb250bWF0dGVyIGZvdW5kLCBjcmVhdGUgZnJvbnRtYXR0ZXIgZnJvbSBzY3JhdGNoXG4gICAgY29uc3QgdiA9IHNldHRpbmdzVG9Db21wYWN0RnJvbnRNYXR0ZXJWYWx1ZShzZXR0aW5ncylcbiAgICBjb25zdCBuZXdGcm9udE1hdHRlciA9IGAtLS1cXG5udW1iZXIgaGVhZGluZ3M6ICR7dn1cXG4tLS1cXG5cXG5gXG4gICAgY29uc3QgZnJvbTogRWRpdG9yUG9zaXRpb24gPSB7IGxpbmU6IDAsIGNoOiAwIH1cbiAgICBjb25zdCB0bzogRWRpdG9yUG9zaXRpb24gPSB7IGxpbmU6IDAsIGNoOiAwIH1cbiAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld0Zyb250TWF0dGVyLCBmcm9tLCB0bylcbiAgICAvLyBGcm9udCBtYXR0ZXIgZG9lcyBub3QgZXhpc3QsIHNvIHdlIHdpbGwgY3JlYXRlIGl0IGZyb20gc2NyYXRjaFxuICB9XG59XG4iLCJpbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nXG5pbXBvcnQgeyBWaWV3SW5mbyB9IGZyb20gJy4vYWN0aXZlVmlld0hlbHBlcnMnXG5pbXBvcnQgeyBzYXZlU2V0dGluZ3NUb0Zyb250TWF0dGVyIH0gZnJvbSAnLi9mcm9udE1hdHRlcidcbmltcG9ydCB7IE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuL3NldHRpbmdzVHlwZXMnXG5cbmV4cG9ydCBpbnRlcmZhY2UgTnVtYmVyaW5nRG9uZUNvbmZpZyB7XG4gIG1lc3NhZ2U6IHN0cmluZ1xuICBwcmVmb3JtYXR0ZWRNZXNzYWdlOiBzdHJpbmdcbiAgc2F2ZVNldHRpbmdzQ2FsbGJhY2s6IChzaG91bGRBZGRBdXRvRmxhZzogYm9vbGVhbikgPT4gdm9pZFxufVxuXG5jbGFzcyBOdW1iZXJpbmdEb25lTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbmZpZzogTnVtYmVyaW5nRG9uZUNvbmZpZ1xuXG4gIGNvbnN0cnVjdG9yIChhcHA6IEFwcCwgY29uZmlnOiBOdW1iZXJpbmdEb25lQ29uZmlnKSB7XG4gICAgc3VwZXIoYXBwKVxuICAgIHRoaXMuY29uZmlnID0gY29uZmlnXG4gIH1cblxuICBvbk9wZW4gKCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGVudEVsLCB0aXRsZUVsIH0gPSB0aGlzXG4gICAgdGl0bGVFbC5zZXRUZXh0KCdOdW1iZXIgSGVhZGluZ3MgLSBTdWNjZXNzZnVsbHkgQ29tcGxldGVkJylcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiB0aGlzLmNvbmZpZy5tZXNzYWdlIH0pXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKCdwcmUnLCB7IHRleHQ6IHRoaXMuY29uZmlnLnByZWZvcm1hdHRlZE1lc3NhZ2UgfSlcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiBcIkRvIHlvdSB3YW50IHRvIHNhdmUgdGhlc2Ugc2V0dGluZ3MgaW4gdGhlIGRvY3VtZW50J3MgZnJvbnQgbWF0dGVyP1wiLCBjbHM6ICdudW1iZXItaGVhZGluZ3MtcXVlc3Rpb24nIH0pXG5cbiAgICBjb25zdCBjb250YWluZXJGb3JCdXR0b25zID0gY29udGVudEVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ251bWJlci1oZWFkaW5ncy1idXR0b24tY29udGFpbmVyJyB9KVxuXG4gICAgY29uc3Qgbm9CdXR0b24gPSBjb250YWluZXJGb3JCdXR0b25zLmNyZWF0ZUVsKCdidXR0b24nLCB7IH0pXG4gICAgbm9CdXR0b24uc2V0VGV4dCgnTm8nKVxuICAgIG5vQnV0dG9uLm9uQ2xpY2tFdmVudCgoZXY6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgcmV0dXJuIGV2XG4gICAgfSlcblxuICAgIGNvbnN0IHllc0J1dHRvbiA9IGNvbnRhaW5lckZvckJ1dHRvbnMuY3JlYXRlRWwoJ2J1dHRvbicsIHsgfSlcbiAgICB5ZXNCdXR0b24uc2V0VGV4dCgnWWVzLCBzYXZlIHNldHRpbmdzIGluIGRvY3VtZW50JylcbiAgICB5ZXNCdXR0b24ub25DbGlja0V2ZW50KChldjogTW91c2VFdmVudCkgPT4ge1xuICAgICAgdGhpcy5jb25maWcuc2F2ZVNldHRpbmdzQ2FsbGJhY2soZmFsc2UpXG4gICAgICB0aGlzLmNsb3NlKClcbiAgICAgIHJldHVybiBldlxuICAgIH0pXG5cbiAgICBjb25zdCB5ZXNBbmRBdXRvQnV0dG9uID0gY29udGFpbmVyRm9yQnV0dG9ucy5jcmVhdGVFbCgnYnV0dG9uJywgeyB9KVxuICAgIHllc0FuZEF1dG9CdXR0b24uc2V0VGV4dCgnWWVzLCBzYXZlIHNldHRpbmdzIGluIGRvY3VtZW50LCBhbmQgYXV0b21hdGljYWxseSBudW1iZXInKVxuICAgIHllc0FuZEF1dG9CdXR0b24ub25DbGlja0V2ZW50KChldjogTW91c2VFdmVudCkgPT4ge1xuICAgICAgdGhpcy5jb25maWcuc2F2ZVNldHRpbmdzQ2FsbGJhY2sodHJ1ZSlcbiAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgcmV0dXJuIGV2XG4gICAgfSlcbiAgfVxuXG4gIG9uQ2xvc2UgKCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGVudEVsLCB0aXRsZUVsIH0gPSB0aGlzXG4gICAgY29udGVudEVsLmVtcHR5KClcbiAgICB0aXRsZUVsLmVtcHR5KClcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hvd051bWJlcmluZ0RvbmVNZXNzYWdlIChhcHA6IEFwcCwgc2V0dGluZ3M6IE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ3MsIHZpZXdJbmZvOiBWaWV3SW5mbyk6IHZvaWQge1xuICBjb25zdCBzYXZlU2V0dGluZ3NDYWxsYmFjayA9IChzaG91bGRBZGRBdXRvRmxhZzogYm9vbGVhbik6IHZvaWQgPT4ge1xuICAgIGNvbnN0IHR3ZWFrZWRTZXR0aW5ncyA9IHsgLi4uc2V0dGluZ3MgfVxuICAgIGlmIChzaG91bGRBZGRBdXRvRmxhZykgdHdlYWtlZFNldHRpbmdzLmF1dG8gPSB0cnVlXG4gICAgc2F2ZVNldHRpbmdzVG9Gcm9udE1hdHRlcih2aWV3SW5mby5kYXRhLCB2aWV3SW5mby5lZGl0b3IsIHR3ZWFrZWRTZXR0aW5ncylcbiAgfVxuICBjb25zdCBjb25maWc6IE51bWJlcmluZ0RvbmVDb25maWcgPSB7XG4gICAgbWVzc2FnZTogYFN1Y2Nlc3NmdWxseSB1cGRhdGVkIGFsbCBoZWFkaW5nIG51bWJlcnMgaW4gdGhlIGRvY3VtZW50LCB1c2luZyB0aGUgc2V0dGluZ3MgYmVsb3cuIFxuICAgICAgU2VlIHNldHRpbmdzIHBhbmVsIHRvIGNoYW5nZSBob3cgaGVhZGluZ3MgYXJlIG51bWJlcmVkLCBvciB1c2UgZnJvbnQgbWF0dGVyXG4gICAgICAoc2VlIHNldHRpbmdzIHBhbmVsKS5gLFxuICAgIHByZWZvcm1hdHRlZE1lc3NhZ2U6IGAgIFNraXAgdG9wIGhlYWRpbmcgbGV2ZWw6ICR7c2V0dGluZ3Muc2tpcFRvcExldmVsfVxuRmlyc3QgaGVhZGluZyBsZXZlbDogJHtzZXR0aW5ncy5maXJzdExldmVsfVxuTWF4aW11bSBoZWFkaW5nIGxldmVsOiAke3NldHRpbmdzLm1heExldmVsfVxuU3R5bGUgZm9yIGxldmVsIDEgaGVhZGluZ3M6ICR7c2V0dGluZ3Muc3R5bGVMZXZlbDF9XG5TdHlsZSBmb3IgbG93ZXIgbGV2ZWwgaGVhZGluZ3MgKGJlbG93IGxldmVsIDEpOiAke3NldHRpbmdzLnN0eWxlTGV2ZWxPdGhlcn1cblNlcGFyYXRvcjogJHtzZXR0aW5ncy5zZXBhcmF0b3J9XG5UYWJsZSBvZiBDb250ZW50cyBBbmNob3I6ICR7c2V0dGluZ3MuY29udGVudHN9YCxcbiAgICBzYXZlU2V0dGluZ3NDYWxsYmFja1xuICB9XG5cbiAgY29uc3QgbGVhZiA9IGFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZlxuICBpZiAobGVhZikge1xuICAgIG5ldyBOdW1iZXJpbmdEb25lTW9kYWwoYXBwLCBjb25maWcpLm9wZW4oKVxuICB9XG59XG4iLCJpbXBvcnQgeyBFZGl0b3IsIEVkaXRvckNoYW5nZSwgRWRpdG9yUmFuZ2UsIEhlYWRpbmdDYWNoZSB9IGZyb20gJ29ic2lkaWFuJ1xuaW1wb3J0IHsgVmlld0luZm8gfSBmcm9tICcuL2FjdGl2ZVZpZXdIZWxwZXJzJ1xuaW1wb3J0IHsgZG9lc0NvbnRlbnRzSGF2ZVZhbHVlLCBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdzIH0gZnJvbSAnLi9zZXR0aW5nc1R5cGVzJ1xuXG5jb25zdCBUT0NfTElTVF9JVEVNX0JVTExFVCA9ICctJ1xuXG5mdW5jdGlvbiBtYWtlSGVhZGluZ0hhc2hTdHJpbmcgKGVkaXRvcjogRWRpdG9yLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBjb25zdCByZWdleCA9IC9eXFxzezAsNH0jKy9nXG4gIGNvbnN0IGhlYWRpbmdMaW5lU3RyaW5nID0gZWRpdG9yLmdldExpbmUoaGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lKVxuICBpZiAoIWhlYWRpbmdMaW5lU3RyaW5nKSByZXR1cm4gdW5kZWZpbmVkXG5cbiAgY29uc3QgbWF0Y2hlcyA9IGhlYWRpbmdMaW5lU3RyaW5nLm1hdGNoKHJlZ2V4KVxuICBpZiAoIW1hdGNoZXMpIHJldHVybiB1bmRlZmluZWRcblxuICBpZiAobWF0Y2hlcy5sZW5ndGggIT09IDEpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUubG9nKFwiVW5leHBlY3RlZCBoZWFkaW5nIGZvcm1hdDogJ1wiICsgaGVhZGluZ0xpbmVTdHJpbmcgKyBcIidcIilcbiAgICByZXR1cm4gdW5kZWZpbmVkXG4gIH1cblxuICBjb25zdCBtYXRjaCA9IG1hdGNoZXNbMF1cbiAgcmV0dXJuIG1hdGNoLnRyaW1MZWZ0KClcbn1cblxuZnVuY3Rpb24gbWFrZU51bWJlcmluZ1N0cmluZyAobnVtYmVyaW5nU3RhY2s6IE51bWJlcmluZ1Rva2VuW10pOiBzdHJpbmcge1xuICBsZXQgbnVtYmVyaW5nU3RyaW5nID0gJydcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IG51bWJlcmluZ1N0YWNrLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGkgPT09IDApIHtcbiAgICAgIG51bWJlcmluZ1N0cmluZyArPSAnICdcbiAgICB9IGVsc2Uge1xuICAgICAgbnVtYmVyaW5nU3RyaW5nICs9ICcuJ1xuICAgIH1cbiAgICBudW1iZXJpbmdTdHJpbmcgKz0gbnVtYmVyaW5nU3RhY2tbaV0udG9TdHJpbmcoKVxuICB9XG5cbiAgcmV0dXJuIG51bWJlcmluZ1N0cmluZ1xufVxuXG5mdW5jdGlvbiBnZXRIZWFkaW5nUHJlZml4UmFuZ2UgKGVkaXRvcjogRWRpdG9yLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBFZGl0b3JSYW5nZSB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IHJlZ2V4ID0gL15cXHN7MCw0fSMrKCApPyhbMC05XStcXC58W0EtWl1cXC4pKihbMC05XSt8W0EtWl0pP1s6Li1dPyggKSsvZ1xuICBjb25zdCBoZWFkaW5nTGluZVN0cmluZyA9IGVkaXRvci5nZXRMaW5lKGhlYWRpbmcucG9zaXRpb24uc3RhcnQubGluZSlcbiAgaWYgKCFoZWFkaW5nTGluZVN0cmluZykgcmV0dXJuIHVuZGVmaW5lZFxuXG4gIGNvbnN0IG1hdGNoZXMgPSBoZWFkaW5nTGluZVN0cmluZy5tYXRjaChyZWdleClcblxuICBpZiAobWF0Y2hlcyAmJiBtYXRjaGVzLmxlbmd0aCAhPT0gMSkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2coXCJVbmV4cGVjdGVkIGhlYWRpbmcgZm9ybWF0OiAnXCIgKyBoZWFkaW5nTGluZVN0cmluZyArIFwiJ1wiKVxuICAgIHJldHVybiB1bmRlZmluZWRcbiAgfVxuXG4gIGNvbnN0IG1hdGNoID0gbWF0Y2hlcyA/IG1hdGNoZXNbMF0gOiAnJ1xuXG4gIGNvbnN0IGZyb20gPSB7XG4gICAgbGluZTogaGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lLFxuICAgIGNoOiAwXG4gIH1cbiAgY29uc3QgdG8gPSB7XG4gICAgbGluZTogaGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lLFxuICAgIGNoOiBtYXRjaC5sZW5ndGhcbiAgfVxuXG4gIHJldHVybiB7IGZyb20sIHRvIH1cbn1cblxudHlwZSBOdW1iZXJpbmdUb2tlbiA9IHN0cmluZyB8IG51bWJlclxuXG5mdW5jdGlvbiB6ZXJvdGhOdW1iZXJpbmdUb2tlbkluU3R5bGUgKHN0eWxlOiBzdHJpbmcpOiBOdW1iZXJpbmdUb2tlbiB7XG4gIGlmIChzdHlsZSA9PT0gJzEnKSB7XG4gICAgcmV0dXJuIDBcbiAgfSBlbHNlIGlmIChzdHlsZSA9PT0gJ0EnKSB7XG4gICAgcmV0dXJuICdaJ1xuICB9XG5cbiAgcmV0dXJuIDBcbn1cblxuZnVuY3Rpb24gZmlyc3ROdW1iZXJpbmdUb2tlbkluU3R5bGUgKHN0eWxlOiBzdHJpbmcpOiBOdW1iZXJpbmdUb2tlbiB7XG4gIGlmIChzdHlsZSA9PT0gJzEnKSB7XG4gICAgcmV0dXJuIDFcbiAgfSBlbHNlIGlmIChzdHlsZSA9PT0gJ0EnKSB7XG4gICAgcmV0dXJuICdBJ1xuICB9XG5cbiAgcmV0dXJuIDFcbn1cblxuZnVuY3Rpb24gbmV4dE51bWJlcmluZ1Rva2VuICh0OiBOdW1iZXJpbmdUb2tlbik6IE51bWJlcmluZ1Rva2VuIHtcbiAgaWYgKHR5cGVvZiB0ID09PSAnbnVtYmVyJykge1xuICAgIHJldHVybiB0ICsgMVxuICB9XG5cbiAgaWYgKHR5cGVvZiB0ID09PSAnc3RyaW5nJykge1xuICAgIGlmICh0ID09PSAnWicpIHJldHVybiAnQSdcbiAgICBlbHNlIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHQuY2hhckNvZGVBdCgwKSArIDEpXG4gIH1cblxuICByZXR1cm4gMVxufVxuXG5mdW5jdGlvbiBjbGVhbkhlYWRpbmdUZXh0Rm9yVG9jIChodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgaWYgKGh0ZXh0LmNvbnRhaW5zKCdeJykpIHtcbiAgICBjb25zdCB4ID0gaHRleHQuc3BsaXQoJ14nKVxuICAgIGlmICh4Lmxlbmd0aCA+IDEpIHtcbiAgICAgIHJldHVybiB4WzBdLnRyaW0oKVxuICAgIH1cbiAgfVxuICByZXR1cm4gaHRleHQudHJpbSgpXG59XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbmZ1bmN0aW9uIGNyZWF0ZVRvY0VudHJ5IChoOiBIZWFkaW5nQ2FjaGUsIHNldHRpbmdzOiBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdzLCBpbml0aWFsSGVhZGluZ0xldmVsOiBudW1iZXIpOnN0cmluZyB7XG4gIGNvbnN0IHRleHQgPSBoLmhlYWRpbmdcbiAgY29uc3QgY2xlYW5UZXh0ID0gY2xlYW5IZWFkaW5nVGV4dEZvclRvYyh0ZXh0KVxuXG4gIGxldCBidWxsZXRJbmRlbnQgPSAnJ1xuICBjb25zdCBzdGFydExldmVsID0gaW5pdGlhbEhlYWRpbmdMZXZlbFxuICBmb3IgKGxldCBpID0gc3RhcnRMZXZlbDsgaSA8IGgubGV2ZWw7IGkrKykge1xuICAgIGJ1bGxldEluZGVudCArPSAnXFx0J1xuICB9XG5cbiAgY29uc3QgZW50cnlMaW5rID0gYFtbIyR7dGV4dH18JHtjbGVhblRleHR9XV1gXG5cbiAgcmV0dXJuIGJ1bGxldEluZGVudCArIFRPQ19MSVNUX0lURU1fQlVMTEVUICsgJyAnICsgZW50cnlMaW5rXG59XG5cbi8vIFJlcGxhY2UgYSByYW5nZSwgYnV0IG9ubHkgaWYgdGhlcmUgaXMgYSBjaGFuZ2UgaW4gdGV4dCwgdG8gcHJldmVudCBwb2x1dGluZyB0aGUgdW5kbyBzdGFja1xuZnVuY3Rpb24gcmVwbGFjZVJhbmdlU2FmZWx5IChlZGl0b3I6IEVkaXRvciwgY2hhbmdlczogRWRpdG9yQ2hhbmdlW10sIHJhbmdlOiBFZGl0b3JSYW5nZSwgdGV4dDogc3RyaW5nKTogdm9pZCB7XG4gIGNvbnN0IHByZXZpb3VzVGV4dCA9IGVkaXRvci5nZXRSYW5nZShyYW5nZS5mcm9tLCByYW5nZS50bylcblxuICBpZiAocHJldmlvdXNUZXh0ICE9PSB0ZXh0KSB7XG4gICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgIHRleHQ6IHRleHQsXG4gICAgICBmcm9tOiByYW5nZS5mcm9tLFxuICAgICAgdG86IHJhbmdlLnRvXG4gICAgfSlcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlSGVhZGluZ051bWJlcmluZyA9IChcbiAgdmlld0luZm86IFZpZXdJbmZvIHwgdW5kZWZpbmVkLFxuICBzZXR0aW5nczogTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5nc1xuKTogdm9pZCA9PiB7XG4gIGlmICghdmlld0luZm8pIHJldHVyblxuICBjb25zdCBoZWFkaW5ncyA9IHZpZXdJbmZvLmRhdGEuaGVhZGluZ3MgPz8gW11cbiAgY29uc3QgZWRpdG9yID0gdmlld0luZm8uZWRpdG9yXG5cbiAgbGV0IHByZXZpb3VzTGV2ZWwgPSAxXG5cbiAgbGV0IG51bWJlcmluZ1N0YWNrOiBOdW1iZXJpbmdUb2tlbltdID0gW3plcm90aE51bWJlcmluZ1Rva2VuSW5TdHlsZShzZXR0aW5ncy5zdHlsZUxldmVsMSldXG5cbiAgaWYgKHNldHRpbmdzLmZpcnN0TGV2ZWwgPiAxKSB7XG4gICAgcHJldmlvdXNMZXZlbCA9IHNldHRpbmdzLmZpcnN0TGV2ZWxcbiAgfSBlbHNlIGlmIChzZXR0aW5ncy5za2lwVG9wTGV2ZWwpIHtcbiAgICBwcmV2aW91c0xldmVsID0gMlxuICB9XG5cbiAgY29uc3QgY2hhbmdlczogRWRpdG9yQ2hhbmdlW10gPSBbXVxuXG4gIGZvciAoY29uc3QgaGVhZGluZyBvZiBoZWFkaW5ncykge1xuICAgIC8vIFVwZGF0ZSB0aGUgbnVtYmVyaW5nIHN0YWNrIGJhc2VkIG9uIHRoZSBsZXZlbCBhbmQgcHJldmlvdXMgbGV2ZWxcblxuICAgIGNvbnN0IGxldmVsID0gaGVhZGluZy5sZXZlbFxuXG4gICAgLy8gSGFuZGxlIHNraXBwZWQgJiBpZ25vcmVkIGxldmVscy5cbiAgICBpZiAoKHNldHRpbmdzLmZpcnN0TGV2ZWwgPiBsZXZlbCkgfHwgKHNldHRpbmdzLnNraXBUb3BMZXZlbCAmJiBsZXZlbCA9PT0gMSkpIHtcbiAgICAgIC8vIFJlc2V0cyB0aGUgbnVtYmVyaW5nIHdoZW4gYSBsZXZlbCBpcyBza2lwcGVkLlxuICAgICAgLy8gTm90ZTogVGhpcyBsZWF2ZXMgaGVhZGluZ3MgYXMgdGhleSBhcmUsIGFsbG93aW5nIHBlb3BsZSB0byBoYXZlIG51bWJlcnMgYXQgdGhlIHN0YXJ0IG9mXG4gICAgICAvLyBpZ25vcmVkIGhlYWRpbmdzLlxuXG4gICAgICBudW1iZXJpbmdTdGFjayA9IFt6ZXJvdGhOdW1iZXJpbmdUb2tlbkluU3R5bGUoc2V0dGluZ3Muc3R5bGVMZXZlbDEpXVxuXG4gICAgICBpZiAoc2V0dGluZ3MuZmlyc3RMZXZlbCA+IDEpIHtcbiAgICAgICAgcHJldmlvdXNMZXZlbCA9IHNldHRpbmdzLmZpcnN0TGV2ZWxcbiAgICAgIH0gZWxzZSBpZiAoc2V0dGluZ3Muc2tpcFRvcExldmVsKSB7XG4gICAgICAgIHByZXZpb3VzTGV2ZWwgPSAyXG4gICAgICB9XG4gICAgICBjb250aW51ZVxuICAgIH1cblxuICAgIC8vIEFkanVzdCBudW1iZXJpbmcgc3RhY2tcbiAgICBpZiAobGV2ZWwgPT09IHByZXZpb3VzTGV2ZWwpIHtcbiAgICAgIGNvbnN0IHggPSBudW1iZXJpbmdTdGFjay5wb3AoKVxuICAgICAgaWYgKHggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBudW1iZXJpbmdTdGFjay5wdXNoKG5leHROdW1iZXJpbmdUb2tlbih4KSlcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGxldmVsIDwgcHJldmlvdXNMZXZlbCkge1xuICAgICAgZm9yIChsZXQgaSA9IHByZXZpb3VzTGV2ZWw7IGkgPiBsZXZlbDsgaS0tKSB7XG4gICAgICAgIG51bWJlcmluZ1N0YWNrLnBvcCgpXG4gICAgICB9XG4gICAgICBjb25zdCB4ID0gbnVtYmVyaW5nU3RhY2sucG9wKClcbiAgICAgIGlmICh4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbnVtYmVyaW5nU3RhY2sucHVzaChuZXh0TnVtYmVyaW5nVG9rZW4oeCkpXG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChsZXZlbCA+IHByZXZpb3VzTGV2ZWwpIHtcbiAgICAgIGZvciAobGV0IGkgPSBwcmV2aW91c0xldmVsOyBpIDwgbGV2ZWw7IGkrKykge1xuICAgICAgICBudW1iZXJpbmdTdGFjay5wdXNoKGZpcnN0TnVtYmVyaW5nVG9rZW5JblN0eWxlKHNldHRpbmdzLnN0eWxlTGV2ZWxPdGhlcikpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2V0IHRoZSBwcmV2aW91cyBsZXZlbCB0byB0aGlzIGxldmVsIGZvciB0aGUgbmV4dCBpdGVyYXRpb25cbiAgICBwcmV2aW91c0xldmVsID0gbGV2ZWxcblxuICAgIGlmIChsZXZlbCA+IHNldHRpbmdzLm1heExldmVsKSB7XG4gICAgICAvLyBJZiB3ZSBhcmUgYWJvdmUgdGhlIG1heCBsZXZlbCwganVzdCBkb24ndCBudW1iZXIgaXRcbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuXG4gICAgLy8gRmluZCB0aGUgcmFuZ2UgdG8gcmVwbGFjZSwgYW5kIHRoZW4gZG8gaXRcbiAgICBjb25zdCBwcmVmaXhSYW5nZSA9IGdldEhlYWRpbmdQcmVmaXhSYW5nZShlZGl0b3IsIGhlYWRpbmcpXG4gICAgaWYgKHByZWZpeFJhbmdlID09PSB1bmRlZmluZWQpIHJldHVyblxuICAgIGNvbnN0IGhlYWRpbmdIYXNoU3RyaW5nID0gbWFrZUhlYWRpbmdIYXNoU3RyaW5nKGVkaXRvciwgaGVhZGluZylcbiAgICBpZiAoaGVhZGluZ0hhc2hTdHJpbmcgPT09IHVuZGVmaW5lZCkgcmV0dXJuXG4gICAgY29uc3QgcHJlZml4U3RyaW5nID0gbWFrZU51bWJlcmluZ1N0cmluZyhudW1iZXJpbmdTdGFjaylcbiAgICByZXBsYWNlUmFuZ2VTYWZlbHkoZWRpdG9yLCBjaGFuZ2VzLCBwcmVmaXhSYW5nZSwgaGVhZGluZ0hhc2hTdHJpbmcgKyBwcmVmaXhTdHJpbmcgKyBzZXR0aW5ncy5zZXBhcmF0b3IgKyAnICcpXG4gIH1cblxuICAvLyBFeGVjdXRlIHRoZSB0cmFuc2FjdGlvbiB0byBtYWtlIGFsbCB0aGUgY2hhbmdlcyBhdCBvbmNlXG4gIGlmIChjaGFuZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUubG9nKCdOdW1iZXIgSGVhZGluZ3MgUGx1Z2luOiBBcHBseWluZyBoZWFkaW5ncyBudW1iZXJpbmcgY2hhbmdlczonLCBjaGFuZ2VzLmxlbmd0aClcbiAgICBlZGl0b3IudHJhbnNhY3Rpb24oe1xuICAgICAgY2hhbmdlczogY2hhbmdlc1xuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHVwZGF0ZVRhYmxlT2ZDb250ZW50cyA9IChcbiAgdmlld0luZm86IFZpZXdJbmZvIHwgdW5kZWZpbmVkLFxuICBzZXR0aW5nczogTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5nc1xuKTogdm9pZCA9PiB7XG4gIGlmICghdmlld0luZm8pIHJldHVyblxuICBjb25zdCBoZWFkaW5ncyA9IHZpZXdJbmZvLmRhdGEuaGVhZGluZ3MgPz8gW11cbiAgY29uc3QgZWRpdG9yID0gdmlld0luZm8uZWRpdG9yXG5cbiAgaWYgKCFkb2VzQ29udGVudHNIYXZlVmFsdWUoc2V0dGluZ3MuY29udGVudHMpKSByZXR1cm5cblxuICBsZXQgdG9jSGVhZGluZzogSGVhZGluZ0NhY2hlIHwgdW5kZWZpbmVkXG4gIGxldCB0b2NCdWlsZGVyID0gJ1xcbidcbiAgY29uc3QgY2hhbmdlczogRWRpdG9yQ2hhbmdlW10gPSBbXVxuXG4gIC8vIEluIGNhc2UgaGVhZGluZ3Mgc3RhcnQgYWJvdmUgbGV2ZWwgMSwgd2UgZG9uJ3Qgd2FudCB0byBpbmRlbnQgdGhlIGJ1bGxldHMgdG9vIG11Y2hcbiAgbGV0IGluaXRpYWxIZWFkaW5nTGV2ZWwgPSAxXG4gIGlmIChoZWFkaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgaW5pdGlhbEhlYWRpbmdMZXZlbCA9IGhlYWRpbmdzWzBdLmxldmVsXG4gIH1cblxuICBmb3IgKGNvbnN0IGhlYWRpbmcgb2YgaGVhZGluZ3MpIHtcbiAgICAvLyBPUkRFUklORzogSW1wb3J0YW50IHRvIGZpbmQgdGhlIFRPQyBoZWFkaW5nIGJlZm9yZSBza2lwcGluZyBza2lwcGVkIGhlYWRpbmdzLCBzaW5jZSB0aGF0IGlzIGZvciBudW1iZXJpbmdcblxuICAgIC8vIEZpbmQgdGhlIFRPQyBoZWFkaW5nXG4gICAgaWYgKGhlYWRpbmcuaGVhZGluZy5lbmRzV2l0aChzZXR0aW5ncy5jb250ZW50cykpIHtcbiAgICAgIHRvY0hlYWRpbmcgPSBoZWFkaW5nXG4gICAgfVxuXG4gICAgLyogVGhpcyBjb2RlIGxldHMgdXMgc2tpcCBUT0MgbGluZXMgZm9yIHNraXBwZWQgaGVhZGluZ3MsIGJ1dCBkb2Vzbid0IHdvcmsgd2VsbCB3aXRoIGZpcnN0LWxldmVsIHNldHRpbmdcbiAgICBpZiAoKHNldHRpbmdzLnNraXBUb3BMZXZlbCAmJiBoZWFkaW5nLmxldmVsID09PSAxKSB8fCAoaGVhZGluZy5sZXZlbCA+IHNldHRpbmdzLm1heExldmVsKSkge1xuICAgICAgY29udGludWVcbiAgICB9XG4gICAgKi9cblxuICAgIGNvbnN0IHRvY0VudHJ5ID0gY3JlYXRlVG9jRW50cnkoaGVhZGluZywgc2V0dGluZ3MsIGluaXRpYWxIZWFkaW5nTGV2ZWwpXG4gICAgdG9jQnVpbGRlciArPSB0b2NFbnRyeSArICdcXG4nXG4gIH1cblxuICAvLyBJbnNlcnQgdGhlIGdlbmVyYXRlZCB0YWJsZSBvZiBjb250ZW50c1xuICBpZiAodG9jSGVhZGluZykge1xuICAgIGNvbnN0IGZyb20gPSB7XG4gICAgICBsaW5lOiB0b2NIZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmUgKyAxLFxuICAgICAgY2g6IDBcbiAgICB9XG5cbiAgICBjb25zdCBzdGFydGluZ0xpbmUgPSB0b2NIZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmUgKyAxXG4gICAgbGV0IGVuZGluZ0xpbmUgPSAwXG4gICAgbGV0IGZvdW5kTGlzdCA9IGZhbHNlXG4gICAgZm9yIChlbmRpbmdMaW5lID0gc3RhcnRpbmdMaW5lOyA7IGVuZGluZ0xpbmUrKykge1xuICAgICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGVuZGluZ0xpbmUpXG4gICAgICBpZiAobGluZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIFJlYWNoZWQgZW5kIG9mIGZpbGUsIGluc2VydCBhdCB0aGUgc3RhcnQgb2YgdGhlIFRPQyBzZWN0aW9uXG4gICAgICAgIGVuZGluZ0xpbmUgPSBzdGFydGluZ0xpbmVcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHRyaW1tZWRMaW5lVGV4dCA9IGxpbmUudHJpbVN0YXJ0KClcbiAgICAgIGlmIChmb3VuZExpc3QpIHtcbiAgICAgICAgaWYgKCF0cmltbWVkTGluZVRleHQuc3RhcnRzV2l0aChUT0NfTElTVF9JVEVNX0JVTExFVCkpIGJyZWFrXG4gICAgICAgIGlmICh0cmltbWVkTGluZVRleHQuc3RhcnRzV2l0aCgnIycpKSBicmVha1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHRyaW1tZWRMaW5lVGV4dC5zdGFydHNXaXRoKFRPQ19MSVNUX0lURU1fQlVMTEVUKSkge1xuICAgICAgICAgIGZvdW5kTGlzdCA9IHRydWVcbiAgICAgICAgfSBlbHNlIGlmICh0cmltbWVkTGluZVRleHQuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICAgICAgLy8gUmVhY2hlZCB0aGUgbmV4dCBoZWFkaW5nIHdpdGhvdXQgZmluZGluZyBleGlzdGluZyBUT0MgbGlzdCwgaW5zZXJ0IGF0IHRoZSBzdGFydCBvZiB0aGUgVE9DIHNlY3Rpb25cbiAgICAgICAgICBlbmRpbmdMaW5lID0gc3RhcnRpbmdMaW5lXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRvY0J1aWxkZXIgPT09ICdcXG4nKSB7XG4gICAgICB0b2NCdWlsZGVyID0gJydcbiAgICB9XG5cbiAgICBjb25zdCB0byA9IHtcbiAgICAgIGxpbmU6IGVuZGluZ0xpbmUsXG4gICAgICBjaDogMFxuICAgIH1cbiAgICBjb25zdCByYW5nZSA9IHsgZnJvbSwgdG8gfVxuICAgIHJlcGxhY2VSYW5nZVNhZmVseShlZGl0b3IsIGNoYW5nZXMsIHJhbmdlLCB0b2NCdWlsZGVyKVxuICB9XG5cbiAgLy8gRXhlY3V0ZSB0aGUgdHJhbnNhY3Rpb24gdG8gbWFrZSBhbGwgdGhlIGNoYW5nZXMgYXQgb25jZVxuICBpZiAoY2hhbmdlcy5sZW5ndGggPiAwKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICBjb25zb2xlLmxvZygnTnVtYmVyIEhlYWRpbmdzIFBsdWdpbjogQXBwbHlpbmcgdGFibGUgb2YgY29udGVudHMgY2hhbmdlczonLCBjaGFuZ2VzLmxlbmd0aClcbiAgICBlZGl0b3IudHJhbnNhY3Rpb24oe1xuICAgICAgY2hhbmdlczogY2hhbmdlc1xuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHJlbW92ZUhlYWRpbmdOdW1iZXJpbmcgPSAoXG4gIHZpZXdJbmZvOiBWaWV3SW5mbyB8IHVuZGVmaW5lZFxuKTogdm9pZCA9PiB7XG4gIGlmICghdmlld0luZm8pIHJldHVyblxuICBjb25zdCBoZWFkaW5ncyA9IHZpZXdJbmZvLmRhdGEuaGVhZGluZ3MgPz8gW11cbiAgY29uc3QgZWRpdG9yID0gdmlld0luZm8uZWRpdG9yXG5cbiAgY29uc3QgY2hhbmdlczogRWRpdG9yQ2hhbmdlW10gPSBbXVxuXG4gIGZvciAoY29uc3QgaGVhZGluZyBvZiBoZWFkaW5ncykge1xuICAgIGNvbnN0IHByZWZpeFJhbmdlID0gZ2V0SGVhZGluZ1ByZWZpeFJhbmdlKGVkaXRvciwgaGVhZGluZylcbiAgICBpZiAocHJlZml4UmFuZ2UgPT09IHVuZGVmaW5lZCkgcmV0dXJuXG4gICAgY29uc3QgaGVhZGluZ0hhc2hTdHJpbmcgPSBtYWtlSGVhZGluZ0hhc2hTdHJpbmcoZWRpdG9yLCBoZWFkaW5nKVxuICAgIGlmIChoZWFkaW5nSGFzaFN0cmluZyA9PT0gdW5kZWZpbmVkKSByZXR1cm5cbiAgICByZXBsYWNlUmFuZ2VTYWZlbHkoZWRpdG9yLCBjaGFuZ2VzLCBwcmVmaXhSYW5nZSwgaGVhZGluZ0hhc2hTdHJpbmcgKyAnICcpXG4gIH1cblxuICBpZiAoY2hhbmdlcy5sZW5ndGggPiAwKSB7XG4gICAgZWRpdG9yLnRyYW5zYWN0aW9uKHtcbiAgICAgIGNoYW5nZXM6IGNoYW5nZXNcbiAgICB9KVxuICB9XG59XG4iLCJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJ1xyXG5pbXBvcnQgeyBnZXRWaWV3SW5mbywgaXNWaWV3QWN0aXZlIH0gZnJvbSAnLi9hY3RpdmVWaWV3SGVscGVycydcclxuaW1wb3J0IHsgZ2V0RnJvbnRNYXR0ZXJTZXR0aW5nc09yQWx0ZXJuYXRpdmUsIHNhdmVTZXR0aW5nc1RvRnJvbnRNYXR0ZXIgfSBmcm9tICcuL2Zyb250TWF0dGVyJ1xyXG5pbXBvcnQgeyBzaG93TnVtYmVyaW5nRG9uZU1lc3NhZ2UgfSBmcm9tICcuL21lc3NhZ2VzJ1xyXG5pbXBvcnQgeyByZW1vdmVIZWFkaW5nTnVtYmVyaW5nLCB1cGRhdGVIZWFkaW5nTnVtYmVyaW5nLCB1cGRhdGVUYWJsZU9mQ29udGVudHMgfSBmcm9tICcuL251bWJlcmluZydcclxuaW1wb3J0IHsgREVGQVVMVF9TRVRUSU5HUywgTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5ncyB9IGZyb20gJy4vc2V0dGluZ3NUeXBlcydcclxuXHJcbmNsYXNzIE51bWJlckhlYWRpbmdzUGx1Z2luU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gIHBsdWdpbjogTnVtYmVySGVhZGluZ3NQbHVnaW5cclxuXHJcbiAgY29uc3RydWN0b3IgKGFwcDogQXBwLCBwbHVnaW46IE51bWJlckhlYWRpbmdzUGx1Z2luKSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbilcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luXHJcbiAgfVxyXG5cclxuICBkaXNwbGF5ICgpOiB2b2lkIHtcclxuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXNcclxuXHJcbiAgICBjb250YWluZXJFbC5lbXB0eSgpXHJcblxyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnTnVtYmVyIEhlYWRpbmdzIC0gU2V0dGluZ3MnIH0pXHJcblxyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2RpdicsIHsgdGV4dDogJ1RvIGFkZCBudW1iZXJpbmcgdG8geW91ciBkb2N1bWVudCwgYnJpbmcgdXAgdGhlIGNvbW1hbmQgd2luZG93IChvbiBNYWMsIHR5cGUgQ01EK1ApLCBhbmQgdGhlbiB0eXBlIFwiTnVtYmVyIEhlYWRpbmdzXCIgdG8gc2VlIGEgbGlzdCBvZiBhdmFpbGFibGUgY29tbWFuZHMuJyB9KVxyXG5cclxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdicicsIHt9KVxyXG5cclxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6ICdJZiB0aGUgZG9jdW1lbnQgaGFzIGZyb250IG1hdHRlciBkZWZpbmVkIHdpdGggdGhlIGJlbG93IHNldHRpbmdzLCB0aGUgcHJvamVjdC13aWRlIHNldHRpbmdzIGRlZmluZWQgb24gdGhpcyBzY3JlZW4gd2lsbCBiZSBpZ25vcmVkLiBZb3UgY2FuIGRlZmluZSBmcm9udCBtYXR0ZXIgbGlrZSB0aGlzOicgfSlcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgncHJlJywge1xyXG4gICAgICB0ZXh0OiBgICAgIC0tLVxyXG4gICAgYWxpYXM6XHJcbiAgICAtIEV4YW1wbGUgQWxpYXNcclxuICAgIHRhZ3M6XHJcbiAgICAtIGV4YW1wbGUtdGFnXHJcbiAgICBudW1iZXIgaGVhZGluZ3M6IGZpcnN0LWxldmVsIDEsIG1heCA2LCAxLjEsIGF1dG8sIGNvbnRlbnRzIF50b2NcclxuICAgIC0tLWBcclxuICAgIH0pXHJcblxyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2RpdicsIHtcclxuICAgICAgdGV4dDogYFxyXG4gICAgICBUaGUgJ251bWJlciBoZWFkaW5ncycgZnJvbnQgbWF0dGVyIGtleSBpcyB1c2VkIHRvIHN0b3JlIG51bWJlcmluZyBzZXR0aW5ncyBzcGVjaWZpYyB0byB0aGUgZmlsZS4gVGhlcmUgYXJlIGZvdXIgcG9zc2libGUgb3B0aW9uc1xyXG4gICAgICBpbiB0aGUgdmFsdWUgdG8gdGhlIHJpZ2h0IG9mIHRoZSBjb2xvbiwgc2VwYXJhdGVkIGJ5IGNvbW1hcy5cclxuICAgIGBcclxuICAgIH0pXHJcblxyXG4gICAgY29uc3QgdWwgPSBjb250YWluZXJFbC5jcmVhdGVFbCgndWwnLCB7fSlcclxuXHJcbiAgICBjb25zdCBsaTAgPSB1bC5jcmVhdGVFbCgnbGknLCB7IH0pXHJcbiAgICBsaTAuY3JlYXRlRWwoJ2InLCB7IHRleHQ6ICdBdXRvbWF0aWMgbnVtYmVyaW5nJyB9KVxyXG4gICAgbGkwLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnOiBJZiBcXCdhdXRvXFwnIGFwcGVhcnMsIHRoZSBkb2N1bWVudCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgbnVtYmVyZWQuJyB9KVxyXG5cclxuICAgIGNvbnN0IGxpMSA9IHVsLmNyZWF0ZUVsKCdsaScsIHsgfSlcclxuICAgIGxpMS5jcmVhdGVFbCgnYicsIHsgdGV4dDogJ0ZpcnN0IGxldmVsIHRvIG51bWJlcicgfSlcclxuICAgIGxpMS5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogJzogSWYgXFwnZmlyc3QtbGV2ZWwgMlxcJyBhcHBlYXJzLCB0aGUgbnVtYmVyaW5nIHdpbGwgc3RhcnQgYXQgdGhlIHNlY29uZCBsZXZlbCcgfSlcclxuXHJcbiAgICBjb25zdCBsaTIgPSB1bC5jcmVhdGVFbCgnbGknLCB7IH0pXHJcbiAgICBsaTIuY3JlYXRlRWwoJ2InLCB7IHRleHQ6ICdNYXhpbXVtIGxldmVsIHRvIG51bWJlcicgfSlcclxuICAgIGxpMi5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogJzogSWYgXFwnbWF4IDZcXCcgYXBwZWFycywgdGhlIGhlYWRpbmdzIGFib3ZlIGxldmVsIDYgd2lsbCBiZSBza2lwcGVkLicgfSlcclxuXHJcbiAgICBjb25zdCBsaTMgPSB1bC5jcmVhdGVFbCgnbGknLCB7IH0pXHJcbiAgICBsaTMuY3JlYXRlRWwoJ2InLCB7IHRleHQ6ICdUYWJsZSBvZiBjb250ZW50cyBhbmNob3InIH0pXHJcbiAgICBsaTMuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICc6IElmIFxcJ2NvbnRlbnRzIF50b2NcXCcgYXBwZWFycywgdGhlIGhlYWRpbmcgdGhhdCBlbmRzIHdpdGggdGhlIGFuY2hvciBedG9jIHdpbGwgaGF2ZSBhIHRhYmxlIG9mIGNvbnRlbnRzIGluc2VydGVkIGJlbmVhdGggaXQuJyB9KVxyXG5cclxuICAgIGNvbnN0IGxpNCA9IHVsLmNyZWF0ZUVsKCdsaScsIHsgfSlcclxuICAgIGxpNC5jcmVhdGVFbCgnYicsIHsgdGV4dDogJ051bWJlcmluZyBzdHlsZScgfSlcclxuICAgIGxpNC5jcmVhdGVFbCgnc3BhbicsIHtcclxuICAgICAgdGV4dDogYDpcclxuICAgICAgQSBzdHlsZSB0ZXh0IGxpa2UgJzEuMScsICdBLjEnLCBvciAnXy4xLjEnIHRlbGxzIHRoZSBwbHVnaW4gaG93IHRvIGZvcm1hdCB0aGUgaGVhZGluZ3MuXHJcbiAgICAgIElmIGEgc3R5bGUgc3RyaW5nIGVuZHMgd2l0aCAnLicgKGEgZG90KSwgJzonIChhIGNvbG9uKSwgb3IgJy0nIChhIGRhc2gpLCB0aGUgaGVhZGluZyBudW1iZXJzIHdpbGwgYmUgc2VwYXJhdGVkIGZyb20gdGhlIGhlYWRpbmcgdGl0bGVcclxuICAgICAgd2l0aCB0aGF0IHN5bWJvbC5gXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IHVsMyA9IGxpNC5jcmVhdGVFbCgndWwnLCB7fSlcclxuICAgIHVsMy5jcmVhdGVFbCgnbGknLCB7XHJcbiAgICAgIHRleHQ6IGAgICAgICBcclxuICAgICAgRm9yIGV4YW1wbGUsICcxLjEnIG1lYW5zIGJvdGggdG9wIGxldmVsIGFuZCBvdGhlciBoZWFkaW5ncyB3aWxsIGJlIG51bWJlcmVkIHN0YXJ0aW5nIGZyb20gJzEnLlxyXG4gICAgYFxyXG4gICAgfSlcclxuICAgIHVsMy5jcmVhdGVFbCgnbGknLCB7XHJcbiAgICAgIHRleHQ6IGAgICAgICBcclxuICAgICAgRm9yIGV4YW1wbGUsICdBLjEnIG1lYW5zIHRvcCBsZXZlbCBoZWFkaW5ncyB3aWxsIGJlIG51bWJlcmVkIHN0YXJ0aW5nIGZyb20gJ0EnLlxyXG4gICAgYFxyXG4gICAgfSlcclxuICAgIHVsMy5jcmVhdGVFbCgnbGknLCB7XHJcbiAgICAgIHRleHQ6IGAgICAgICBcclxuICAgICAgRm9yIGV4YW1wbGUsICdfLkEuMScgbWVhbnMgdG9wIGxldmVsIGhlYWRpbmdzIHdpbGwgTk9UIGJlIG51bWJlcmVkLCBidXQgdGhlIG5leHQgbGV2ZWxzIHdpbGwgYmUgbnVtYmVyZWQgd2l0aCBsZXR0ZXJzIGFuZCBudW1iZXJzLlxyXG4gICAgYFxyXG4gICAgfSlcclxuICAgIHVsMy5jcmVhdGVFbCgnbGknLCB7XHJcbiAgICAgIHRleHQ6IGAgICAgICBcclxuICAgICAgRm9yIGV4YW1wbGUsICcxLjE6JyBtZWFucyBoZWFkaW5ncyB3aWxsIGxvb2sgbGlrZSAnIyMgMi40OiBFeGFtcGxlIEhlYWRpbmcnXHJcbiAgICBgXHJcbiAgICB9KVxyXG4gICAgdWwzLmNyZWF0ZUVsKCdsaScsIHtcclxuICAgICAgdGV4dDogYCAgICAgIFxyXG4gICAgICBGb3IgZXhhbXBsZSwgJ0EuMS0nIG1lYW5zIGhlYWRpbmdzIHdpbGwgbG9vayBsaWtlICcjIyBCLjUtIEV4YW1wbGUgSGVhZGluZydcclxuICAgIGBcclxuICAgIH0pXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdTa2lwIHRvcCBoZWFkaW5nIGxldmVsJylcclxuICAgICAgLnNldERlc2MoJ0lmIHNlbGVjdGVkLCBudW1iZXJpbmcgd2lsbCBub3QgYmUgYXBwbGllZCB0byB0aGUgdG9wIGhlYWRpbmcgbGV2ZWwuJylcclxuICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNraXBUb3BMZXZlbClcclxuICAgICAgICAuc2V0VG9vbHRpcCgnU2tpcCB0b3AgaGVhZGluZyBsZXZlbCcpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2tpcFRvcExldmVsID0gdmFsdWVcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXHJcbiAgICAgICAgfSkpXHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdGaXJzdCBoZWFkaW5nIGxldmVsJylcclxuICAgICAgLnNldERlc2MoJ0ZpcnN0IGhlYWRpbmcgbGV2ZWwgdG8gbnVtYmVyLicpXHJcbiAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxyXG4gICAgICAgIC5zZXRMaW1pdHMoMSwgNiwgMSlcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlyc3RMZXZlbClcclxuICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZpcnN0TGV2ZWwgPSB2YWx1ZVxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcclxuICAgICAgICB9KSlcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ01heGltdW0gaGVhZGluZyBsZXZlbCcpXHJcbiAgICAgIC5zZXREZXNjKCdNYXhpbXVtIGhlYWRpbmcgbGV2ZWwgdG8gbnVtYmVyLicpXHJcbiAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxyXG4gICAgICAgIC5zZXRMaW1pdHMoMSwgNiwgMSlcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4TGV2ZWwpXHJcbiAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhMZXZlbCA9IHZhbHVlXHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnU3R5bGUgZm9yIGxldmVsIDEgaGVhZGluZ3MnKVxyXG4gICAgICAuc2V0RGVzYygnRGVmaW5lcyB0aGUgbnVtYmVyaW5nIHN0eWxlIGZvciBsZXZlbCBvbmUgaGVhZGluZ3MuIFZhbGlkIHZhbHVlcyBhcmUgMSAoZm9yIG51bWJlcnMpIG9yIEEgKGZvciBjYXBpdGFsIGxldHRlcnMpLicpXHJcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdHlsZUxldmVsMSlcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdHlsZUxldmVsMSA9IHZhbHVlXHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnU3R5bGUgZm9yIGxvd2VyIGxldmVsIGhlYWRpbmdzIChiZWxvdyBsZXZlbCAxKScpXHJcbiAgICAgIC5zZXREZXNjKCdEZWZpbmVzIHRoZSBudW1iZXJpbmcgc3R5bGUgZm9yIGhlYWRpbmdzIGJlbG93IGxldmVsIG9uZS4gVmFsaWQgdmFsdWVzIGFyZSAxIChmb3IgbnVtYmVycykgb3IgQSAoZm9yIGNhcGl0YWwgbGV0dGVycykuJylcclxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnN0eWxlTGV2ZWxPdGhlcilcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdHlsZUxldmVsT3RoZXIgPSB2YWx1ZVxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcclxuICAgICAgICB9KSlcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ0F1dG9tYXRpYyBudW1iZXJpbmcnKVxyXG4gICAgICAuc2V0RGVzYygnVHVybnMgb24gYXV0b21hdGljIG51bWJlcmluZyBvZiBkb2N1bWVudHMuJylcclxuICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG8pXHJcbiAgICAgICAgLnNldFRvb2x0aXAoJ1R1cm4gb24gYXV0b21hdGljIG51bWJlcmluZycpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0byA9IHZhbHVlXHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnU2VwYXJhdG9yIHN0eWxlJylcclxuICAgICAgLnNldERlc2MoJ0RlZmluZXMgdGhlIHNlcGFyYXRvciBzdHlsZSBiZXR3ZWVuIHRoZSBoZWFkaW5nIG51bWJlciBhbmQgdGhlIGhlYWRpbmcgdGV4dC4gVmFsaWQgdmFsdWVzIGFyZSA6IChjb2xvbikgb3IgLiAoZG90KSBvciAtIChkYXNoKS4gWW91IGNhbiBhbHNvIGxlYXZlIGl0IGJsYW5rIGZvciBubyBzZXBhcmF0b3IuJylcclxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlcGFyYXRvcilcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXBhcmF0b3IgPSB2YWx1ZVxyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKClcclxuICAgICAgICB9KSlcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1RhYmxlIG9mIENvbnRlbnRzIEFuY2hvcicpXHJcbiAgICAgIC5zZXREZXNjKCdBbmNob3Igd2hpY2ggbGFiZWxzIHRoZSBoZWFkZXIgd2hlcmUgYSB0YWJsZSBvZiBjb250ZW50cyBzaG91bGQgYmUgaW5zZXJ0ZWQuIFRoZSBhbmNob3Igc2hvdWxkIGJlIGFkZGVkIGF0IHRoZSBlbmQgb2YgYSBoZWFkZXIuIEZvciBleGFtcGxlLCBedG9jLicpXHJcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50cylcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50cyA9IHZhbHVlXHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxyXG4gICAgICAgIH0pKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTnVtYmVySGVhZGluZ3NQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xyXG4gIHNldHRpbmdzITogTnVtYmVySGVhZGluZ3NQbHVnaW5TZXR0aW5nc1xyXG5cclxuICBhc3luYyBvbmxvYWQgKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgIGNvbnNvbGUuaW5mbygnTG9hZGluZyBOdW1iZXIgSGVhZGluZ3MgUGx1Z2luLCB2ZXJzaW9uICcgKyB0aGlzLm1hbmlmZXN0LnZlcnNpb24pXHJcblxyXG4gICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKVxyXG5cclxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgIGlkOiAnbnVtYmVyLWhlYWRpbmdzLXdpdGgtb3B0aW9ucycsXHJcbiAgICAgIG5hbWU6ICdOdW1iZXIgYWxsIGhlYWRpbmdzIGluIGRvY3VtZW50IChhbmQgc2hvdyBvcHRpb25zKScsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgIGlmIChjaGVja2luZykgcmV0dXJuIGlzVmlld0FjdGl2ZSh0aGlzLmFwcClcclxuXHJcbiAgICAgICAgY29uc3Qgdmlld0luZm8gPSBnZXRWaWV3SW5mbyh0aGlzLmFwcClcclxuICAgICAgICBpZiAodmlld0luZm8pIHtcclxuICAgICAgICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0RnJvbnRNYXR0ZXJTZXR0aW5nc09yQWx0ZXJuYXRpdmUodmlld0luZm8uZGF0YSwgdGhpcy5zZXR0aW5ncylcclxuICAgICAgICAgIHVwZGF0ZUhlYWRpbmdOdW1iZXJpbmcodmlld0luZm8sIHNldHRpbmdzKVxyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIEhBQ0s6IFRoaXMgbXVzdCBoYXBwZW4gYWZ0ZXIgYSB0aW1lb3V0IHNvIHRoYXQgdGhlcmUgaXMgdGltZSBmb3IgdGhlIGVkaXRvciB0cmFuc2FjdGlvbiB0byBjb21wbGV0ZVxyXG4gICAgICAgICAgICBjb25zdCBwb3N0TnVtYmVyaW5nVmlld0luZm8gPSBnZXRWaWV3SW5mbyh0aGlzLmFwcClcclxuICAgICAgICAgICAgdXBkYXRlVGFibGVPZkNvbnRlbnRzKHBvc3ROdW1iZXJpbmdWaWV3SW5mbywgc2V0dGluZ3MpXHJcbiAgICAgICAgICB9LCAzMDAwKVxyXG5cclxuICAgICAgICAgIHNob3dOdW1iZXJpbmdEb25lTWVzc2FnZSh0aGlzLmFwcCwgc2V0dGluZ3MsIHZpZXdJbmZvKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICdudW1iZXItaGVhZGluZ3MnLFxyXG4gICAgICBuYW1lOiAnTnVtYmVyIGFsbCBoZWFkaW5ncyBpbiBkb2N1bWVudCcsXHJcbiAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgIGlmIChjaGVja2luZykgcmV0dXJuIGlzVmlld0FjdGl2ZSh0aGlzLmFwcClcclxuXHJcbiAgICAgICAgY29uc3Qgdmlld0luZm8gPSBnZXRWaWV3SW5mbyh0aGlzLmFwcClcclxuICAgICAgICBpZiAodmlld0luZm8pIHtcclxuICAgICAgICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0RnJvbnRNYXR0ZXJTZXR0aW5nc09yQWx0ZXJuYXRpdmUodmlld0luZm8uZGF0YSwgdGhpcy5zZXR0aW5ncylcclxuICAgICAgICAgIHVwZGF0ZUhlYWRpbmdOdW1iZXJpbmcodmlld0luZm8sIHNldHRpbmdzKVxyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIEhBQ0s6IFRoaXMgbXVzdCBoYXBwZW4gYWZ0ZXIgYSB0aW1lb3V0IHNvIHRoYXQgdGhlcmUgaXMgdGltZSBmb3IgdGhlIGVkaXRvciB0cmFuc2FjdGlvbiB0byBjb21wbGV0ZVxyXG4gICAgICAgICAgICBjb25zdCBwb3N0TnVtYmVyaW5nVmlld0luZm8gPSBnZXRWaWV3SW5mbyh0aGlzLmFwcClcclxuICAgICAgICAgICAgdXBkYXRlVGFibGVPZkNvbnRlbnRzKHBvc3ROdW1iZXJpbmdWaWV3SW5mbywgc2V0dGluZ3MpXHJcbiAgICAgICAgICB9LCAzMDAwKVxyXG5cclxuICAgICAgICAgIC8vIE5PVEU6IFRoZSBsaW5lIGJlbG93IGlzIGludGVudGlvbmFsbHkgY29tbWVudGVkIG91dCwgc2luY2UgdGhpcyBjb21tYW5kIGlzIHRoZSBzYW1lIGFzXHJcbiAgICAgICAgICAvLyAgICAgICB0aGUgYWJvdmUgY29tbWFuZCwgZXhjZXB0IGZvciB0aGlzIGxpbmVcclxuICAgICAgICAgIC8vIHNob3dOdW1iZXJpbmdEb25lTWVzc2FnZSh0aGlzLmFwcCwgc2V0dGluZ3MsIHZpZXdJbmZvKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgaWQ6ICdyZW1vdmUtbnVtYmVyLWhlYWRpbmdzJyxcclxuICAgICAgbmFtZTogJ1JlbW92ZSBudW1iZXJpbmcgZnJvbSBhbGwgaGVhZGluZ3MgaW4gZG9jdW1lbnQnLFxyXG4gICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICBpZiAoY2hlY2tpbmcpIHJldHVybiBpc1ZpZXdBY3RpdmUodGhpcy5hcHApXHJcblxyXG4gICAgICAgIGNvbnN0IHZpZXdJbmZvID0gZ2V0Vmlld0luZm8odGhpcy5hcHApXHJcbiAgICAgICAgcmVtb3ZlSGVhZGluZ051bWJlcmluZyh2aWV3SW5mbylcclxuXHJcbiAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogJ3NhdmUtc2V0dGluZ3MtdG8tZnJvbnQtbWF0dGVyJyxcclxuICAgICAgbmFtZTogJ1NhdmUgc2V0dGluZ3MgdG8gZnJvbnQgbWF0dGVyJyxcclxuICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgaWYgKGNoZWNraW5nKSByZXR1cm4gaXNWaWV3QWN0aXZlKHRoaXMuYXBwKVxyXG5cclxuICAgICAgICBjb25zdCB2aWV3SW5mbyA9IGdldFZpZXdJbmZvKHRoaXMuYXBwKVxyXG4gICAgICAgIGlmICh2aWV3SW5mbykge1xyXG4gICAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBnZXRGcm9udE1hdHRlclNldHRpbmdzT3JBbHRlcm5hdGl2ZSh2aWV3SW5mby5kYXRhLCB0aGlzLnNldHRpbmdzKVxyXG4gICAgICAgICAgc2F2ZVNldHRpbmdzVG9Gcm9udE1hdHRlcih2aWV3SW5mby5kYXRhLCB2aWV3SW5mby5lZGl0b3IsIHNldHRpbmdzKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBOdW1iZXJIZWFkaW5nc1BsdWdpblNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKVxyXG5cclxuICAgIHRoaXMucmVnaXN0ZXJJbnRlcnZhbCh3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICBjb25zdCB2aWV3SW5mbyA9IGdldFZpZXdJbmZvKHRoaXMuYXBwKVxyXG4gICAgICBpZiAodmlld0luZm8pIHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IGdldEZyb250TWF0dGVyU2V0dGluZ3NPckFsdGVybmF0aXZlKHZpZXdJbmZvLmRhdGEsIHRoaXMuc2V0dGluZ3MpXHJcblxyXG4gICAgICAgIGlmIChzZXR0aW5ncy5hdXRvKSB7XHJcbiAgICAgICAgICB1cGRhdGVIZWFkaW5nTnVtYmVyaW5nKHZpZXdJbmZvLCBzZXR0aW5ncylcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBIQUNLOiBUaGlzIG11c3QgaGFwcGVuIGFmdGVyIGEgdGltZW91dCBzbyB0aGF0IHRoZXJlIGlzIHRpbWUgZm9yIHRoZSBlZGl0b3IgdHJhbnNhY3Rpb24gdG8gY29tcGxldGVcclxuICAgICAgICAgICAgY29uc3QgcG9zdE51bWJlcmluZ1ZpZXdJbmZvID0gZ2V0Vmlld0luZm8odGhpcy5hcHApXHJcbiAgICAgICAgICAgIHVwZGF0ZVRhYmxlT2ZDb250ZW50cyhwb3N0TnVtYmVyaW5nVmlld0luZm8sIHNldHRpbmdzKVxyXG4gICAgICAgICAgfSwgMzAwMClcclxuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnTnVtYmVyIEhlYWRpbmdzIFBsdWdpbjogQXV0b21hdGljYWxseSBudW1iZXJlZCBkb2N1bWVudCcpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LCAxMCAqIDEwMDApKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZFNldHRpbmdzICgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpXHJcbiAgfVxyXG5cclxuICBhc3luYyBzYXZlU2V0dGluZ3MgKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTWFya2Rvd25WaWV3IiwicGFyc2VGcm9udE1hdHRlckVudHJ5IiwiTW9kYWwiLCJQbHVnaW5TZXR0aW5nVGFiIiwiU2V0dGluZyIsIlBsdWdpbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXVEQTtBQUNPLFNBQVMsU0FBUyxDQUFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRTtBQUM3RCxJQUFJLFNBQVMsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLE9BQU8sS0FBSyxZQUFZLENBQUMsR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUMsVUFBVSxPQUFPLEVBQUUsRUFBRSxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRTtBQUNoSCxJQUFJLE9BQU8sS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLE9BQU8sQ0FBQyxFQUFFLFVBQVUsT0FBTyxFQUFFLE1BQU0sRUFBRTtBQUMvRCxRQUFRLFNBQVMs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
