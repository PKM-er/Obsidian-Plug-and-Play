/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Kn=Object.create;var ye=Object.defineProperty;var Yn=Object.getOwnPropertyDescriptor;var Xn=Object.getOwnPropertyNames,Nt=Object.getOwnPropertySymbols,Zn=Object.getPrototypeOf,Ot=Object.prototype.hasOwnProperty,er=Object.prototype.propertyIsEnumerable;var It=(t,e,n)=>e in t?ye(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zt=(t,e)=>{for(var n in e||(e={}))Ot.call(e,n)&&It(t,n,e[n]);if(Nt)for(var n of Nt(e))er.call(e,n)&&It(t,n,e[n]);return t};var Bt=t=>ye(t,"__esModule",{value:!0});var tr=(t,e)=>{Bt(t);for(var n in e)ye(t,n,{get:e[n],enumerable:!0})},nr=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Xn(e))!Ot.call(t,r)&&r!=="default"&&ye(t,r,{get:()=>e[r],enumerable:!(n=Yn(e,r))||n.enumerable});return t},ie=t=>nr(Bt(ye(t!=null?Kn(Zn(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);tr(exports,{default:()=>Tt});var Ze=ie(require("obsidian"));var Be=ie(require("obsidian"));var O=function(){return O=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},O.apply(this,arguments)};function E(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(l){s={error:l}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}var rr="ENTRIES",Lt="KEYS",Pt="VALUES",z="",tt=function(){function t(e,n){var r=e._tree,i=Array.from(r.keys());this.set=e,this._type=n,this._path=i.length>0?[{node:r,keys:i}]:[]}return t.prototype.next=function(){var e=this.dive();return this.backtrack(),e},t.prototype.dive=function(){if(this._path.length===0)return{done:!0,value:void 0};var e=pe(this._path),n=e.node,r=e.keys;if(pe(r)===z)return{done:!1,value:this.result()};var i=n.get(pe(r));return this._path.push({node:i,keys:Array.from(i.keys())}),this.dive()},t.prototype.backtrack=function(){if(this._path.length!==0){var e=pe(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}},t.prototype.key=function(){return this.set._prefix+this._path.map(function(e){var n=e.keys;return pe(n)}).filter(function(e){return e!==z}).join("")},t.prototype.value=function(){return pe(this._path).node.get(z)},t.prototype.result=function(){switch(this._type){case Pt:return this.value();case Lt:return this.key();default:return[this.key(),this.value()]}},t.prototype[Symbol.iterator]=function(){return this},t}(),pe=function(t){return t[t.length-1]},ir=function(t,e,n){var r=new Map;if(e===void 0)return r;for(var i=e.length+1,o=i+n,s=new Uint8Array(o*i).fill(n+1),l=0;l<i;++l)s[l]=l;for(var a=1;a<o;++a)s[a*i]=a;return Rt(t,e,n,r,s,1,i,""),r},Rt=function(t,e,n,r,i,o,s,l){var a,u,c=o*s;try{e:for(var f=E(t.keys()),h=f.next();!h.done;h=f.next()){var d=h.value;if(d===z){var m=i[c-1];m<=n&&r.set(l,[t.get(d),m])}else{for(var _=o,v=0;v<d.length;++v,++_){for(var g=d[v],y=s*_,p=y-s,w=i[y],x=Math.max(0,_-n-1),A=Math.min(s-1,_+n),D=x;D<A;++D){var M=g!==e[D],W=i[p+D]+ +M,Q=i[p+D+1]+1,P=i[y+D]+1,R=i[y+D+1]=Math.min(W,Q,P);R<w&&(w=R)}if(w>n)continue e}Rt(t.get(d),e,n,r,i,_,s,l+d)}}}catch(U){a={error:U}}finally{try{h&&!h.done&&(u=f.return)&&u.call(f)}finally{if(a)throw a.error}}},nt=function(){function t(e,n){e===void 0&&(e=new Map),n===void 0&&(n=""),this._size=void 0,this._tree=e,this._prefix=n}return t.prototype.atPrefix=function(e){var n,r;if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");var i=I(Me(this._tree,e.slice(this._prefix.length)),2),o=i[0],s=i[1];if(o===void 0){var l=I(ot(s),2),a=l[0],u=l[1];try{for(var c=E(a.keys()),f=c.next();!f.done;f=c.next()){var h=f.value;if(h!==z&&h.startsWith(u)){var d=new Map;return d.set(h.slice(u.length),a.get(h)),new t(d,e)}}}catch(m){n={error:m}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}return new t(o,e)},t.prototype.clear=function(){this._size=void 0,this._tree.clear()},t.prototype.delete=function(e){return this._size=void 0,or(this._tree,e)},t.prototype.entries=function(){return new tt(this,rr)},t.prototype.forEach=function(e){var n,r;try{for(var i=E(this),o=i.next();!o.done;o=i.next()){var s=I(o.value,2),l=s[0],a=s[1];e(l,a,this)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.fuzzyGet=function(e,n){return ir(this._tree,e,n)},t.prototype.get=function(e){var n=rt(this._tree,e);return n!==void 0?n.get(z):void 0},t.prototype.has=function(e){var n=rt(this._tree,e);return n!==void 0&&n.has(z)},t.prototype.keys=function(){return new tt(this,Lt)},t.prototype.set=function(e,n){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var r=it(this._tree,e);return r.set(z,n),this},Object.defineProperty(t.prototype,"size",{get:function(){if(this._size)return this._size;this._size=0;for(var e=this.entries();!e.next().done;)this._size+=1;return this._size},enumerable:!1,configurable:!0}),t.prototype.update=function(e,n){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var r=it(this._tree,e);return r.set(z,n(r.get(z))),this},t.prototype.fetch=function(e,n){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var r=it(this._tree,e),i=r.get(z);return i===void 0&&r.set(z,i=n()),i},t.prototype.values=function(){return new tt(this,Pt)},t.prototype[Symbol.iterator]=function(){return this.entries()},t.from=function(e){var n,r,i=new t;try{for(var o=E(e),s=o.next();!s.done;s=o.next()){var l=I(s.value,2),a=l[0],u=l[1];i.set(a,u)}}catch(c){n={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},t.fromObject=function(e){return t.from(Object.entries(e))},t}(),Me=function(t,e,n){var r,i;if(n===void 0&&(n=[]),e.length===0||t==null)return[t,n];try{for(var o=E(t.keys()),s=o.next();!s.done;s=o.next()){var l=s.value;if(l!==z&&e.startsWith(l))return n.push([t,l]),Me(t.get(l),e.slice(l.length),n)}}catch(a){r={error:a}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return n.push([t,e]),Me(void 0,"",n)},rt=function(t,e){var n,r;if(e.length===0||t==null)return t;try{for(var i=E(t.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;if(s!==z&&e.startsWith(s))return rt(t.get(s),e.slice(s.length))}}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},it=function(t,e){var n,r,i=e.length;e:for(var o=0;t&&o<i;){try{for(var s=(n=void 0,E(t.keys())),l=s.next();!l.done;l=s.next()){var a=l.value;if(a!==z&&e[o]===a[0]){for(var u=Math.min(i-o,a.length),c=1;c<u&&e[o+c]===a[c];)++c;var f=t.get(a);if(c===a.length)t=f;else{var h=new Map;h.set(a.slice(c),f),t.set(e.slice(o,o+c),h),t.delete(a),t=h}o+=c;continue e}}}catch(m){n={error:m}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}var d=new Map;return t.set(e.slice(o),d),d}return t},or=function(t,e){var n=I(Me(t,e),2),r=n[0],i=n[1];if(r!==void 0){if(r.delete(z),r.size===0)Ht(i);else if(r.size===1){var o=I(r.entries().next().value,2),s=o[0],l=o[1];jt(i,s,l)}}},Ht=function(t){if(t.length!==0){var e=I(ot(t),2),n=e[0],r=e[1];if(n.delete(r),n.size===0)Ht(t.slice(0,-1));else if(n.size===1){var i=I(n.entries().next().value,2),o=i[0],s=i[1];o!==z&&jt(t.slice(0,-1),o,s)}}},jt=function(t,e,n){if(t.length!==0){var r=I(ot(t),2),i=r[0],o=r[1];i.set(o+e,n),i.delete(o)}},ot=function(t){return t[t.length-1]},_e,st="or",sr="and",ar="and_not",Vt=function(){function t(e){if((e==null?void 0:e.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');this._options=O(O(O({},lt),e),{searchOptions:O(O({},Ut),e.searchOptions||{})}),this._index=new nt,this._documentCount=0,this._documentIds=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this.addFields(this._options.fields)}return t.prototype.add=function(e){var n,r,i,o,s=this._options,l=s.extractField,a=s.tokenize,u=s.processTerm,c=s.fields,f=s.idField,h=l(e,f);if(h==null)throw new Error('MiniSearch: document does not have ID field "'.concat(f,'"'));var d=this.addDocumentId(h);this.saveStoredFields(d,e);try{for(var m=E(c),_=m.next();!_.done;_=m.next()){var v=_.value,g=l(e,v);if(g!=null){var y=a(g.toString(),v),p=this._fieldIds[v],w=new Set(y).size;this.addFieldLength(d,p,this._documentCount-1,w);try{for(var x=(i=void 0,E(y)),A=x.next();!A.done;A=x.next()){var D=A.value,M=u(D,v);M&&this.addTerm(p,d,M)}}catch(W){i={error:W}}finally{try{A&&!A.done&&(o=x.return)&&o.call(x)}finally{if(i)throw i.error}}}}}catch(W){n={error:W}}finally{try{_&&!_.done&&(r=m.return)&&r.call(m)}finally{if(n)throw n.error}}},t.prototype.addAll=function(e){var n,r;try{for(var i=E(e),o=i.next();!o.done;o=i.next()){var s=o.value;this.add(s)}}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.addAllAsync=function(e,n){var r=this;n===void 0&&(n={});var i=n.chunkSize,o=i===void 0?10:i,s={chunk:[],promise:Promise.resolve()},l=e.reduce(function(c,f,h){var d=c.chunk,m=c.promise;return d.push(f),(h+1)%o==0?{chunk:[],promise:m.then(function(){return new Promise(function(_){return setTimeout(_,0)})}).then(function(){return r.addAll(d)})}:{chunk:d,promise:m}},s),a=l.chunk,u=l.promise;return u.then(function(){return r.addAll(a)})},t.prototype.remove=function(e){var n,r,i,o,s,l,a=this._options,u=a.tokenize,c=a.processTerm,f=a.extractField,h=a.fields,d=a.idField,m=f(e,d);if(m==null)throw new Error('MiniSearch: document does not have ID field "'.concat(d,'"'));try{for(var _=E(this._documentIds),v=_.next();!v.done;v=_.next()){var g=I(v.value,2),y=g[0],p=g[1];if(m===p){try{for(var w=(i=void 0,E(h)),x=w.next();!x.done;x=w.next()){var A=x.value,D=f(e,A);if(D!=null){var M=u(D.toString(),A),W=this._fieldIds[A],Q=new Set(M).size;this.removeFieldLength(y,W,this._documentCount,Q);try{for(var P=(s=void 0,E(M)),R=P.next();!R.done;R=P.next()){var U=R.value,re=c(U,A);re&&this.removeTerm(W,y,re)}}catch(X){s={error:X}}finally{try{R&&!R.done&&(l=P.return)&&l.call(P)}finally{if(s)throw s.error}}}}}catch(X){i={error:X}}finally{try{x&&!x.done&&(o=w.return)&&o.call(w)}finally{if(i)throw i.error}}this._storedFields.delete(y),this._documentIds.delete(y),this._fieldLength.delete(y),this._documentCount-=1;return}}}catch(X){n={error:X}}finally{try{v&&!v.done&&(r=_.return)&&r.call(_)}finally{if(n)throw n.error}}throw new Error("MiniSearch: cannot remove document with ID ".concat(m,": it is not in the index"))},t.prototype.removeAll=function(e){var n,r;if(e)try{for(var i=E(e),o=i.next();!o.done;o=i.next()){var s=o.value;this.remove(s)}}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new nt,this._documentCount=0,this._documentIds=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}},t.prototype.search=function(e,n){var r,i;n===void 0&&(n={});var o=this.executeQuery(e,n),s=[];try{for(var l=E(o),a=l.next();!a.done;a=l.next()){var u=I(a.value,2),c=u[0],f=u[1],h=f.score,d=f.terms,m=f.match,_=d.length,v={id:this._documentIds.get(c),score:h*_,terms:Object.keys(m),match:m};Object.assign(v,this._storedFields.get(c)),(n.filter==null||n.filter(v))&&s.push(v)}}catch(g){r={error:g}}finally{try{a&&!a.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return s.sort(qt),s},t.prototype.autoSuggest=function(e,n){var r,i,o,s;n===void 0&&(n={}),n=O(O({},dr),n);var l=new Map;try{for(var a=E(this.search(e,n)),u=a.next();!u.done;u=a.next()){var c=u.value,f=c.score,h=c.terms,d=h.join(" "),m=l.get(d);m!=null?(m.score+=f,m.count+=1):l.set(d,{score:f,terms:h,count:1})}}catch(x){r={error:x}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}var _=[];try{for(var v=E(l),g=v.next();!g.done;g=v.next()){var y=I(g.value,2),m=y[0],p=y[1],f=p.score,h=p.terms,w=p.count;_.push({suggestion:m,terms:h,score:f/w})}}catch(x){o={error:x}}finally{try{g&&!g.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}return _.sort(qt),_},Object.defineProperty(t.prototype,"documentCount",{get:function(){return this._documentCount},enumerable:!1,configurable:!0}),t.loadJSON=function(e,n){if(n==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return t.loadJS(JSON.parse(e),n)},t.getDefault=function(e){if(lt.hasOwnProperty(e))return at(lt,e);throw new Error('MiniSearch: unknown option "'.concat(e,'"'))},t.loadJS=function(e,n){var r,i,o,s,l=e.index,a=e.documentCount,u=e.nextId,c=e.documentIds,f=e.fieldIds,h=e.fieldLength,d=e.averageFieldLength,m=e.storedFields,_=e.serializationVersion;if(_!==1&&_!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");var v=new t(n);v._documentCount=a,v._nextId=u,v._documentIds=De(c),v._fieldIds=f,v._fieldLength=De(h),v._avgFieldLength=d,v._storedFields=De(m),v._index=new nt;try{for(var g=E(l),y=g.next();!y.done;y=g.next()){var p=I(y.value,2),w=p[0],x=p[1],A=new Map;try{for(var D=(o=void 0,E(Object.keys(x))),M=D.next();!M.done;M=D.next()){var W=M.value,Q=x[W];_===1&&(Q=Q.ds),A.set(parseInt(W,10),De(Q))}}catch(P){o={error:P}}finally{try{M&&!M.done&&(s=D.return)&&s.call(D)}finally{if(o)throw o.error}}v._index.set(w,A)}}catch(P){r={error:P}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(r)throw r.error}}return v},t.prototype.executeQuery=function(e,n){var r=this;if(n===void 0&&(n={}),typeof e!="string"){var i=O(O(O({},n),e),{queries:void 0}),o=e.queries.map(function(v){return r.executeQuery(v,i)});return this.combineResults(o,e.combineWith)}var s=this._options,l=s.tokenize,a=s.processTerm,u=s.searchOptions,c=O(O({tokenize:l,processTerm:a},u),n),f=c.tokenize,h=c.processTerm,d=f(e).map(function(v){return h(v)}).filter(function(v){return!!v}),m=d.map(fr(c)),_=m.map(function(v){return r.executeQuerySpec(v,c)});return this.combineResults(_,c.combineWith)},t.prototype.executeQuerySpec=function(e,n){var r,i,o,s,l=O(O({},this._options.searchOptions),n),a=(l.fields||this._options.fields).reduce(function(he,$t){var et;return O(O({},he),(et={},et[$t]=at(he,$t)||1,et))},l.boost||{}),u=l.boostDocument,c=l.weights,f=l.maxFuzzy,h=O(O({},Ut.weights),c),d=h.fuzzy,m=h.prefix,_=this._index.get(e.term),v=this.termResults(e.term,e.term,1,_,a,u),g,y;if(e.prefix&&(g=this._index.atPrefix(e.term)),e.fuzzy){var p=e.fuzzy===!0?.2:e.fuzzy,w=p<1?Math.min(f,Math.round(e.term.length*p)):p;w&&(y=this._index.fuzzyGet(e.term,w))}if(g)try{for(var x=E(g),A=x.next();!A.done;A=x.next()){var D=I(A.value,2),M=D[0],W=D[1],Q=M.length-e.term.length;if(!!Q){y==null||y.delete(M);var P=m*M.length/(M.length+.3*Q);this.termResults(e.term,M,P,W,a,u,v)}}}catch(he){r={error:he}}finally{try{A&&!A.done&&(i=x.return)&&i.call(x)}finally{if(r)throw r.error}}if(y)try{for(var R=E(y.keys()),U=R.next();!U.done;U=R.next()){var M=U.value,re=I(y.get(M),2),X=re[0],Q=re[1];if(!!Q){var P=d*M.length/(M.length+Q);this.termResults(e.term,M,P,X,a,u,v)}}}catch(he){o={error:he}}finally{try{U&&!U.done&&(s=R.return)&&s.call(R)}finally{if(o)throw o.error}}return v},t.prototype.combineResults=function(e,n){if(n===void 0&&(n=st),e.length===0)return new Map;var r=n.toLowerCase();return e.reduce(lr[r])||new Map},t.prototype.toJSON=function(){var e,n,r,i,o=[];try{for(var s=E(this._index),l=s.next();!l.done;l=s.next()){var a=I(l.value,2),u=a[0],c=a[1],f={};try{for(var h=(r=void 0,E(c)),d=h.next();!d.done;d=h.next()){var m=I(d.value,2),_=m[0],v=m[1];f[_]=Object.fromEntries(v)}}catch(g){r={error:g}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}o.push([u,f])}}catch(g){e={error:g}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),index:o,serializationVersion:2}},t.prototype.termResults=function(e,n,r,i,o,s,l){var a,u,c,f,h;if(l===void 0&&(l=new Map),i==null)return l;try{for(var d=E(Object.keys(o)),m=d.next();!m.done;m=d.next()){var _=m.value,v=o[_],g=this._fieldIds[_],y=i.get(g);if(y!=null){var p=y.size,w=this._avgFieldLength[g];try{for(var x=(c=void 0,E(y.keys())),A=x.next();!A.done;A=x.next()){var D=A.value,M=s?s(this._documentIds.get(D),n):1;if(!!M){var W=y.get(D),Q=this._fieldLength.get(D)[g],P=cr(W,p,this._documentCount,Q,w),R=r*v*M*P,U=l.get(D);if(U){U.score+=R,hr(U.terms,e);var re=at(U.match,n);re?re.push(_):U.match[n]=[_]}else l.set(D,{score:R,terms:[e],match:(h={},h[n]=[_],h)})}}}catch(X){c={error:X}}finally{try{A&&!A.done&&(f=x.return)&&f.call(x)}finally{if(c)throw c.error}}}}}catch(X){a={error:X}}finally{try{m&&!m.done&&(u=d.return)&&u.call(d)}finally{if(a)throw a.error}}return l},t.prototype.addTerm=function(e,n,r){var i=this._index.fetch(r,Jt),o=i.get(e);if(o==null)o=new Map,o.set(n,1),i.set(e,o);else{var s=o.get(n);o.set(n,(s||0)+1)}},t.prototype.removeTerm=function(e,n,r){if(!this._index.has(r)){this.warnDocumentChanged(n,e,r);return}var i=this._index.fetch(r,Jt),o=i.get(e);o==null||o.get(n)==null?this.warnDocumentChanged(n,e,r):o.get(n)<=1?o.size<=1?i.delete(e):o.delete(n):o.set(n,o.get(n)-1),this._index.get(r).size===0&&this._index.delete(r)},t.prototype.warnDocumentChanged=function(e,n,r){var i,o;if(!(console==null||console.warn==null))try{for(var s=E(Object.keys(this._fieldIds)),l=s.next();!l.done;l=s.next()){var a=l.value;if(this._fieldIds[a]===n){console.warn("MiniSearch: document with ID ".concat(this._documentIds.get(e),' has changed before removal: term "').concat(r,'" was not present in field "').concat(a,'". Removing a document after it has changed can corrupt the index!'));return}}}catch(u){i={error:u}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}},t.prototype.addDocumentId=function(e){var n=this._nextId;return this._documentIds.set(n,e),this._documentCount+=1,this._nextId+=1,n},t.prototype.addFields=function(e){for(var n=0;n<e.length;n++)this._fieldIds[e[n]]=n},t.prototype.addFieldLength=function(e,n,r,i){var o=this._fieldLength.get(e);o==null&&this._fieldLength.set(e,o=[]),o[n]=i;var s=this._avgFieldLength[n]||0,l=s*r+i;this._avgFieldLength[n]=l/(r+1)},t.prototype.removeFieldLength=function(e,n,r,i){var o=this._avgFieldLength[n]*r-i;this._avgFieldLength[n]=o/(r-1)},t.prototype.saveStoredFields=function(e,n){var r,i,o=this._options,s=o.storeFields,l=o.extractField;if(!(s==null||s.length===0)){var a=this._storedFields.get(e);a==null&&this._storedFields.set(e,a={});try{for(var u=E(s),c=u.next();!c.done;c=u.next()){var f=c.value,h=l(n,f);h!==void 0&&(a[f]=h)}}catch(d){r={error:d}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}},t}(),at=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},lr=(_e={},_e[st]=function(t,e){var n,r;try{for(var i=E(e.keys()),o=i.next();!o.done;o=i.next()){var s=o.value,l=t.get(s);if(l==null)t.set(s,e.get(s));else{var a=e.get(s),u=a.score,c=a.terms,f=a.match;l.score=l.score+u,l.match=Object.assign(l.match,f),Gt(l.terms,c)}}}catch(h){n={error:h}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},_e[sr]=function(t,e){var n,r,i=new Map;try{for(var o=E(e.keys()),s=o.next();!s.done;s=o.next()){var l=s.value,a=t.get(l);if(a!=null){var u=e.get(l),c=u.score,f=u.terms,h=u.match;Gt(a.terms,f),i.set(l,{score:a.score+c,terms:a.terms,match:Object.assign(a.match,h)})}}}catch(d){n={error:d}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},_e[ar]=function(t,e){var n,r;try{for(var i=E(e.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;t.delete(s)}}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},_e),Wt=1.2,Qt=.7,ur=.5,cr=function(t,e,n,r,i){var o=Math.log(1+(n-e+.5)/(e+.5));return o*(ur+t*(Wt+1)/(t+Wt*(1-Qt+Qt*r/i)))},fr=function(t){return function(e,n,r){var i=typeof t.fuzzy=="function"?t.fuzzy(e,n,r):t.fuzzy||!1,o=typeof t.prefix=="function"?t.prefix(e,n,r):t.prefix===!0;return{term:e,fuzzy:i,prefix:o}}},lt={idField:"id",extractField:function(t,e){return t[e]},tokenize:function(t,e){return t.split(pr)},processTerm:function(t,e){return t.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[]},Ut={combineWith:st,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375}},dr={prefix:function(t,e,n){return e===n.length-1}},hr=function(t,e){t.includes(e)||t.push(e)},Gt=function(t,e){var n,r;try{for(var i=E(e),o=i.next();!o.done;o=i.next()){var s=o.value;t.includes(s)||t.push(s)}}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},qt=function(t,e){var n=t.score,r=e.score;return r-n},Jt=function(){return new Map},De=function(t){var e,n,r=new Map;try{for(var i=E(Object.keys(t)),o=i.next();!o.done;o=i.next()){var s=o.value;r.set(parseInt(s,10),t[s])}}catch(l){e={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},pr=/[\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;var ut=class{constructor(){this.handlers=new Map;this.disabled=[]}on(e,n,r){if(e.includes("@")||n.includes("@"))throw new Error("Invalid context/event name - Cannot contain @");this.handlers.set(`${e}@${n}`,r)}off(e,n){if(n)this.handlers.delete(`${e}@${n}`);else for(let[r]of this.handlers.entries())r.startsWith(`${e}@`)&&this.handlers.delete(r)}disable(e){this.enable(e),this.disabled.push(e)}enable(e){this.disabled=this.disabled.filter(n=>n!==e)}emit(e,...n){for(let[r,i]of this.handlers.entries()){let o=r.split("@")[0];this.disabled.includes(o)||r.endsWith(`@${e}`)&&i(...n)}}};var Kt=/^"|"$|^'|'$/g,Yt=/[\u4e00-\u9fa5]/,Xt=100,Te=180,Zt="suggestion-highlight omnisearch-highlight",$=new ut;var en=!1;function ct(t){en=t}function tn(){return en}var nn=/[|\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;function oe(t){return`<span class="${Zt}">${t}</span>`}function mr(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function rn(t){return new Promise(e=>{setTimeout(e,t)})}function gr(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function se(t){return t.length?new RegExp(t.map(e=>`(${gr(e)})`).join("|"),"gi"):/^$/}function $e(t,e){return t.headings?.filter(n=>n.level===e).map(n=>n.heading)??[]}function Ne(t,e){return(t+e)%e}function Oe(t,e){let n=e??-1;if(n>-1){let r=Math.max(0,n-Xt),i=Math.min(t.length,n+Te);t=(r>0?"\u2026":"")+t.slice(r,i).trim()+(i<t.length-1?"\u2026":"")}return mr(t)}function on(t){return t.replace(Kt,"")}function ft(t){return t.replace(/(\*|_)+(.+?)(\*|_)+/g,(e,n,r)=>r)}function sn(t){let e=t?.frontmatter?.aliases??[];return(Array.isArray(e)?e:e.split(",")).map(n=>n&&n.trim()).filter(n=>!!n)}var Z=ie(require("obsidian")),dt=class extends Z.PluginSettingTab{constructor(e){super(app,e);this.plugin=e}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Omnisearch settings"}),new Z.Setting(e).setName("Show indexing notices").setDesc("Show a notice when indexing is done, usually at startup.").addToggle(n=>n.setValue(N.showIndexingNotices).onChange(async r=>{N.showIndexingNotices=r,await Ie(this.plugin)})),new Z.Setting(e).setName(`Respect Obsidian's "Excluded Files"`).setDesc(`Files that are in Obsidian's "Options > Files & Links > Excluded Files" list will be downranked in results.`).addToggle(n=>n.setValue(N.respectExcluded).onChange(async r=>{N.respectExcluded=r,await Ie(this.plugin)})),require("electron")?new Z.Setting(e).setName("Reindex in real-time").setDesc("By default, notes a reindexed when Obsidian focus is lost. Enable this to reindex in real-time. May affect performances.").addToggle(n=>n.setValue(N.reindexInRealTime).onChange(async r=>{N.reindexInRealTime=r,await Ie(this.plugin)})):N.reindexInRealTime=!1,new Z.Setting(e).setName("Results weighting").setHeading(),new Z.Setting(e).setName(`File name & declared aliases (default: ${me.weightBasename})`).addSlider(n=>this.weightSlider(n,"weightBasename")),new Z.Setting(e).setName(`Headings level 1 (default: ${me.weightH1})`).addSlider(n=>this.weightSlider(n,"weightH1")),new Z.Setting(e).setName(`Headings level 2 (default: ${me.weightH2})`).addSlider(n=>this.weightSlider(n,"weightH2")),new Z.Setting(e).setName(`Headings level 3 (default: ${me.weightH3})`).addSlider(n=>this.weightSlider(n,"weightH3"))}weightSlider(e,n){e.setLimits(1,3,.1),e.setValue(N[n]),e.setDynamicTooltip(),e.onChange(r=>{N[n]=r,Ie(this.plugin)})}},me={showIndexingNotices:!1,respectExcluded:!0,reindexInRealTime:!1,weightBasename:2,weightH1:1.5,weightH2:1.3,weightH3:1.1},N=Object.assign({},me);async function an(t){N=Object.assign({},me,await t.loadData())}async function Ie(t){await t.saveData(N)}var ht=ie(require("obsidian"));var Fe={};function ln(){Fe={}}function Y(t){return Fe[t]}function un(){return Object.values(Fe).filter(t=>t.doesNotExist)}function pt(t,e){Fe[t]=e}function cn(t){delete Fe[t]}async function ze(t,e=!1){let n=se(t.foundWords);n.exec(t.content);let r=n.lastIndex;await app.workspace.openLinkText(t.path,"",e);let i=app.workspace.getActiveViewOfType(ht.MarkdownView);if(!i)throw new Error("OmniSearch - No active MarkdownView");let o=i.editor.offsetToPos(r);o.ch=0,i.editor.setCursor(o),i.editor.scrollIntoView({from:{line:o.line-10,ch:0},to:{line:o.line+10,ch:0}})}async function fn(t){try{let e=await app.vault.create(t+".md","# "+t+`
`);await app.workspace.openLinkText(e.path,"");let n=app.workspace.getActiveViewOfType(ht.MarkdownView);if(!n)throw new Error("OmniSearch - No active MarkdownView");let r=n.editor.offsetToPos(t.length+5);r.ch=0}catch(e){throw console.error(e),e}}function dn(t,e){return(e.links??[]).map(n=>{let r=mt(n.link);return app.metadataCache.getFirstLinkpathDest(r,t.path)?"":n.link}).filter(n=>!!n)}function mt(t){return t.split(/[\^#]+/)[0]}var we,vr=t=>{let e=t.split(nn),n=app.plugins.plugins["cm-chs-patch"];return n?e.flatMap(r=>Yt.test(r)?n.cut(r):[r]):e};async function hn(){ln(),we=new Vt({tokenize:vr,idField:"path",fields:["basename","aliases","content","headings1","headings2","headings3"]});let t=new Date().getTime(),e=app.vault.getMarkdownFiles();e.length&&console.log("Omnisearch - indexing "+e.length+" files");for(let n=0;n<e.length;++n){n%10==0&&await rn(0);let r=e[n];r&&await ge(r)}e.length>0&&N.showIndexingNotices&&new Be.Notice(`Omnisearch - Indexed ${e.length} notes in ${new Date().getTime()-t}ms`)}async function yr(t){if(!t.segmentsToStr())return[];let e=we.search(t.segmentsToStr(),{prefix:!0,fuzzy:i=>i.length>4?.2:!1,combineWith:"AND",boost:{basename:N.weightBasename,aliases:N.weightBasename,headings1:N.weightH1,headings2:N.weightH2,headings3:N.weightH3}});N.respectExcluded&&e.forEach(i=>{app.metadataCache.isUserIgnored&&app.metadataCache.isUserIgnored(i.id)&&(i.score/=3)});let n=t.getExactTerms();n.length&&(e=e.filter(i=>{let o=Y(i.id)?.path.toLowerCase()??"",s=ft(Y(i.id)?.content??"").toLowerCase();return n.every(l=>s.includes(l)||o.includes(l))}));let r=t.exclusions;return r.length&&(e=e.filter(i=>{let o=ft(Y(i.id)?.content??"").toLowerCase();return r.every(s=>!o.includes(s.value))})),e}function gt(t,e){let n=null,r=[],i=0;for(;(n=e.exec(t))!==null&&!(++i>100);){let o=n[0];o&&r.push({match:o,offset:n.index})}return r}async function Le(t,e){let n=await yr(t);if(!n.length)return[];if(e?.singleFilePath){let i=n.find(o=>o.id===e.singleFilePath);i?n=[i]:n=[]}else n=n.slice(0,50);return n.map(i=>{let o=Y(i.id);if(!o)throw new Error(`Note "${i.id}" not indexed`);let s=[...Object.keys(i.match).filter(u=>t.segments.some(c=>u.startsWith(c.value))),...t.segments.filter(u=>u.exact).map(u=>u.value)],l=gt(o.content,se(s));return zt({score:i.score,foundWords:s,matches:l},o)})}async function ge(t){if(!(!(t instanceof Be.TFile)||t.extension!=="md")){Y(t.path)?.doesNotExist&&ae(t.path);try{let e=app.metadataCache.getFileCache(t);if(e){let i=dn(t,e);for(let o of i.filter(s=>!Y(s)))_r(o,t.path)}if(Y(t.path))throw new Error(`${t.basename} is already indexed`);let n=await app.vault.cachedRead(t),r={basename:t.path,content:n,path:t.path,aliases:sn(e).join(""),headings1:e?$e(e,1).join(" "):"",headings2:e?$e(e,2).join(" "):"",headings3:e?$e(e,3).join(" "):""};we.add(r),pt(r.path,r)}catch(e){console.trace("Error while indexing "+t.basename),console.error(e)}}}function _r(t,e){if(t=mt(t),Y(t))return;let n=t+(t.endsWith(".md")?"":".md"),r={path:n,basename:t,content:"",aliases:"",headings1:"",headings2:"",headings3:"",doesNotExist:!0,parent:e};we.add(r),pt(n,r)}function ae(t){if(!t.endsWith(".md")){console.info(`"${t}" is not a .md file`);return}let e=Y(t);e?(we.remove(e),cn(t),un().filter(n=>n.parent===t).forEach(n=>{ae(n.path)})):console.warn(`not not found under path ${t}`)}var vt=new Set;function pn(t){vt.add(t)}async function mn(){for(let t of vt)ae(t.path),await ge(t);vt.clear()}var qn=ie(require("obsidian"));function q(){}function Fr(t,e){for(let n in e)t[n]=e[n];return t}function yt(t){return t()}function gn(){return Object.create(null)}function te(t){t.forEach(yt)}function vn(t){return typeof t=="function"}function H(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function yn(t){return Object.keys(t).length===0}function Pe(t,e,n,r){if(t){let i=_n(t,e,n,r);return t[0](i)}}function _n(t,e,n,r){return t[1]&&r?Fr(n.ctx.slice(),t[1](r(e))):n.ctx}function Re(t,e,n,r){if(t[2]&&r){let i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){let o=[],s=Math.max(e.dirty.length,i.length);for(let l=0;l<s;l+=1)o[l]=e.dirty[l]|i[l];return o}return e.dirty|i}return e.dirty}function He(t,e,n,r,i,o){if(i){let s=_n(e,n,r,o);t.p(s,i)}}function je(t){if(t.ctx.length>32){let e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}var bi=new Set;var Fn=!1;function wr(){Fn=!0}function xr(){Fn=!1}function J(t,e){t.appendChild(e)}function b(t,e,n){t.insertBefore(e,n||null)}function F(t){t.parentNode.removeChild(t)}function Ve(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function k(t){return document.createElement(t)}function ve(t){return document.createTextNode(t)}function B(){return ve(" ")}function xe(){return ve("")}function ee(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function S(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function br(t){return Array.from(t.childNodes)}function _t(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Ft(t,e){t.value=e??""}function wt(t,e,n){t.classList[n?"add":"remove"](e)}function Er(t,e,{bubbles:n=!1,cancelable:r=!1}={}){let i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}var Ei=new Map;var be;function Ee(t){be=t}function xt(){if(!be)throw new Error("Function called outside component initialization");return be}function le(t){xt().$$.on_mount.push(t)}function bt(t){xt().$$.on_destroy.push(t)}function Et(){let t=xt();return(e,n,{cancelable:r=!1}={})=>{let i=t.$$.callbacks[e];if(i){let o=Er(e,n,{cancelable:r});return i.slice().forEach(s=>{s.call(t,o)}),!o.defaultPrevented}return!0}}function ne(t,e){let n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}var Ae=[];var We=[],Qe=[],wn=[],xn=Promise.resolve(),At=!1;function bn(){At||(At=!0,xn.then(En))}function ue(){return bn(),xn}function St(t){Qe.push(t)}var Ct=new Set,Ue=0;function En(){let t=be;do{for(;Ue<Ae.length;){let e=Ae[Ue];Ue++,Ee(e),Ar(e.$$)}for(Ee(null),Ae.length=0,Ue=0;We.length;)We.pop()();for(let e=0;e<Qe.length;e+=1){let n=Qe[e];Ct.has(n)||(Ct.add(n),n())}Qe.length=0}while(Ae.length);for(;wn.length;)wn.pop()();At=!1,Ct.clear(),Ee(t)}function Ar(t){if(t.fragment!==null){t.update(),te(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(St)}}var Ge=new Set,ce;function fe(){ce={r:0,c:[],p:ce}}function de(){ce.r||te(ce.c),ce=ce.p}function C(t,e){t&&t.i&&(Ge.delete(t),t.i(e))}function T(t,e,n,r){if(t&&t.o){if(Ge.has(t))return;Ge.add(t),ce.c.push(()=>{Ge.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}var Ai=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;var Si=new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);function K(t){t&&t.c()}function G(t,e,n,r){let{fragment:i,on_mount:o,on_destroy:s,after_update:l}=t.$$;i&&i.m(e,n),r||St(()=>{let a=o.map(yt).filter(vn);s?s.push(...a):te(a),t.$$.on_mount=[]}),l.forEach(St)}function j(t,e){let n=t.$$;n.fragment!==null&&(te(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Sr(t,e){t.$$.dirty[0]===-1&&(Ae.push(t),bn(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function V(t,e,n,r,i,o,s,l=[-1]){let a=be;Ee(t);let u=t.$$={fragment:null,ctx:null,props:o,update:q,not_equal:i,bound:gn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:gn(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};s&&s(u.root);let c=!1;if(u.ctx=n?n(t,e.props||{},(f,h,...d)=>{let m=d.length?d[0]:h;return u.ctx&&i(u.ctx[f],u.ctx[f]=m)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](m),c&&Sr(t,f)),h}):[],u.update(),c=!0,te(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){wr();let f=br(e.target);u.fragment&&u.fragment.l(f),f.forEach(F)}else u.fragment&&u.fragment.c();e.intro&&C(t.$$.fragment),G(t,e.target,e.anchor,e.customElement),xr(),En()}Ee(a)}var Cr;typeof HTMLElement=="function"&&(Cr=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(yt).filter(vn);for(let e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){te(this.$$.on_disconnect)}$destroy(){j(this,1),this.$destroy=q}$on(t,e){let n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{let r=n.indexOf(e);r!==-1&&n.splice(r,1)}}$set(t){this.$$set&&!yn(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});var L=class{$destroy(){j(this,1),this.$destroy=q}$on(e,n){let r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{let i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!yn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var Ye=ie(require("obsidian"));var An=ie(require("obsidian"));function kr(t){let e,n,r;return{c(){e=k("input"),S(e,"type","text"),S(e,"class","prompt-input"),S(e,"placeholder","Type to search through your notes"),S(e,"spellcheck","false")},m(i,o){b(i,e,o),Ft(e,t[0]),t[4](e),n||(r=[ee(e,"input",t[3]),ee(e,"input",t[2]),ee(e,"compositionstart",t[5]),ee(e,"compositionend",t[6])],n=!0)},p(i,[o]){o&1&&e.value!==i[0]&&Ft(e,i[0])},i:q,o:q,d(i){i&&F(e),t[4](null),n=!1,te(r)}}}function Mr(t,e,n){let{value:r=""}=e,i=Et(),o;le(async()=>{await ue(),o.focus(),o.select()});let s=(0,An.debounce)(()=>{i("input",r)},100);function l(){r=this.value,n(0,r)}function a(f){We[f?"unshift":"push"](()=>{o=f,n(1,o)})}let u=f=>ct(!0),c=f=>ct(!1);return t.$$set=f=>{"value"in f&&n(0,r=f.value)},[r,o,s,l,a,u,c]}var Sn=class extends L{constructor(e){super();V(this,e,Mr,kr,H,{value:0})}},qe=Sn;function Dr(t){let e,n,r,i,o=t[1].default,s=Pe(o,t,t[0],null);return{c(){e=k("div"),s&&s.c(),S(e,"class","prompt-results")},m(l,a){b(l,e,a),s&&s.m(e,null),n=!0,r||(i=ee(e,"mousedown",Tr),r=!0)},p(l,[a]){s&&s.p&&(!n||a&1)&&He(s,o,l,l[0],n?Re(o,l[0],a,null):je(l[0]),null)},i(l){n||(C(s,l),n=!0)},o(l){T(s,l),n=!1},d(l){l&&F(e),s&&s.d(l),r=!1,i()}}}var Tr=t=>t.preventDefault();function $r(t,e,n){let{$$slots:r={},$$scope:i}=e;return t.$$set=o=>{"$$scope"in o&&n(0,i=o.$$scope)},[i,r]}var Cn=class extends L{constructor(e){super();V(this,e,$r,Dr,H,{})}},Je=Cn;function Nr(t){let e;return{c(){e=k("span"),e.innerHTML='<svg viewBox="0 0 100 100" class="add-note-glyph" width="16" height="16"><path fill="currentColor" stroke="currentColor" d="M23.3,6.7c-3.7,0-6.7,3-6.7,6.7v73.3c0,3.7,3,6.7,6.7,6.7h28.4c-3.2-4.8-5.1-10.5-5.1-16.7c0-16.6,13.4-30,30-30 c2.3,0,4.5,0.3,6.7,0.8V31.7c0-0.9-0.3-1.7-1-2.4L60.7,7.6c-0.6-0.6-1.5-1-2.4-1L23.3,6.7z M56.7,13L77,33.3H60 c-1.8,0-3.3-1.5-3.3-3.3L56.7,13z M76.7,53.3c-12.9,0-23.3,10.4-23.3,23.3S63.8,100,76.7,100S100,89.6,100,76.7 S89.6,53.3,76.7,53.3z M76.7,63.3c1.8,0,3.3,1.5,3.3,3.3v6.7h6.7c1.8,0,3.3,1.5,3.3,3.3c0,1.8-1.5,3.3-3.3,3.3H80v6.7 c0,1.8-1.5,3.3-3.3,3.3c-1.8,0-3.3-1.5-3.3-3.3V80h-6.7c-1.8,0-3.3-1.5-3.3-3.3s1.5-3.3,3.3-3.3h6.7v-6.7 C73.3,64.8,74.8,63.3,76.7,63.3L76.7,63.3z"></path></svg>',S(e,"class","suggestion-flair"),S(e,"aria-label","Not created yet, select to create")},m(n,r){b(n,e,r)},p:q,i:q,o:q,d(n){n&&F(e)}}}function Or(t){"use strict";return[]}var kn=class extends L{constructor(e){super();V(this,e,Or,Nr,H,{})}},Mn=kn;function Dn(t){let e,n;return e=new Mn({}),{c(){K(e.$$.fragment)},m(r,i){G(e,r,i),n=!0},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){T(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function Ir(t){let e,n,r,i,o,s=t[2]&&Dn(t),l=t[4].default,a=Pe(l,t,t[3],null);return{c(){e=k("div"),s&&s.c(),n=B(),a&&a.c(),S(e,"data-result-id",t[0]),S(e,"class","suggestion-item omnisearch-result"),wt(e,"is-selected",t[1])},m(u,c){b(u,e,c),s&&s.m(e,null),J(e,n),a&&a.m(e,null),r=!0,i||(o=[ee(e,"mousemove",t[5]),ee(e,"click",t[6]),ee(e,"auxclick",t[7])],i=!0)},p(u,[c]){u[2]?s?c&4&&C(s,1):(s=Dn(u),s.c(),C(s,1),s.m(e,n)):s&&(fe(),T(s,1,1,()=>{s=null}),de()),a&&a.p&&(!r||c&8)&&He(a,l,u,u[3],r?Re(l,u[3],c,null):je(u[3]),null),(!r||c&1)&&S(e,"data-result-id",u[0]),c&2&&wt(e,"is-selected",u[1])},i(u){r||(C(s),C(a,u),r=!0)},o(u){T(s),T(a,u),r=!1},d(u){u&&F(e),s&&s.d(),a&&a.d(u),i=!1,te(o)}}}function zr(t,e,n){let{$$slots:r={},$$scope:i}=e,{id:o}=e,{selected:s=!1}=e,{glyph:l=!1}=e;function a(f){ne.call(this,t,f)}function u(f){ne.call(this,t,f)}function c(f){ne.call(this,t,f)}return t.$$set=f=>{"id"in f&&n(0,o=f.id),"selected"in f&&n(1,s=f.selected),"glyph"in f&&n(2,l=f.glyph),"$$scope"in f&&n(3,i=f.$$scope)},[o,s,l,i,r,a,u,c]}var Tn=class extends L{constructor(e){super();V(this,e,zr,Ir,H,{id:0,selected:1,glyph:2})}},Ke=Tn;function $n(t){let e,n=t[5].length+"",r,i,o=(t[5].length>1?"matches":"match")+"",s;return{c(){e=k("span"),r=ve(n),i=ve("\xA0"),s=ve(o),S(e,"class","omnisearch-result__counter")},m(l,a){b(l,e,a),J(e,r),J(e,i),J(e,s)},p(l,a){a&32&&n!==(n=l[5].length+"")&&_t(r,n),a&32&&o!==(o=(l[5].length>1?"matches":"match")+"")&&_t(s,o)},d(l){l&&F(e)}}}function Br(t){let e,n=t[1].basename.replace(t[2],oe)+"",r,i,o,s=t[4].replace(t[2],oe)+"",l=t[5].length>0&&$n(t);return{c(){e=k("span"),r=B(),l&&l.c(),i=B(),o=k("div"),S(e,"class","omnisearch-result__title"),S(o,"class","omnisearch-result__body")},m(a,u){b(a,e,u),e.innerHTML=n,b(a,r,u),l&&l.m(a,u),b(a,i,u),b(a,o,u),o.innerHTML=s},p(a,u){u&6&&n!==(n=a[1].basename.replace(a[2],oe)+"")&&(e.innerHTML=n),a[5].length>0?l?l.p(a,u):(l=$n(a),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null),u&20&&s!==(s=a[4].replace(a[2],oe)+"")&&(o.innerHTML=s)},d(a){a&&F(e),a&&F(r),l&&l.d(a),a&&F(i),a&&F(o)}}}function Lr(t){let e,n;return e=new Ke({props:{id:t[1].path,selected:t[0],glyph:t[3],$$slots:{default:[Br]},$$scope:{ctx:t}}}),e.$on("mousemove",t[6]),e.$on("click",t[7]),{c(){K(e.$$.fragment)},m(r,i){G(e,r,i),n=!0},p(r,[i]){let o={};i&2&&(o.id=r[1].path),i&1&&(o.selected=r[0]),i&8&&(o.glyph=r[3]),i&310&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){T(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function Pr(t,e,n){let r,i,o,s,{selected:l=!1}=e,{note:a}=e;function u(f){ne.call(this,t,f)}function c(f){ne.call(this,t,f)}return t.$$set=f=>{"selected"in f&&n(0,l=f.selected),"note"in f&&n(1,a=f.note)},t.$$.update=()=>{if(t.$$.dirty&2){e:n(2,r=se(a.foundWords))}if(t.$$.dirty&6){e:n(5,i=gt(a.content,r))}if(t.$$.dirty&2){e:n(4,o=Oe(a.content,a.matches[0]?.offset??-1))}if(t.$$.dirty&2){e:n(3,s=Y(a.path)?.doesNotExist)}},[l,a,r,s,o,i,u,c]}var Nn=class extends L{constructor(e){super();V(this,e,Pr,Lr,H,{selected:0,note:1})}},On=Nn;function In(t,e){e?e.offsets=typeof e.offsets=="undefined"?!0:e.offsets:e={offsets:!0,tokenize:!0},t||(t="");let n={text:[],offsets:[],exclude:{text:[]}};e.offsets&&(n.offsets=[]);let r={text:[]},i=[],o=/(\S+:'(?:[^'\\]|\\.)*')|(\S+:"(?:[^"\\]|\\.)*")|(-?"(?:[^"\\]|\\.)*")|(-?'(?:[^'\\]|\\.)*')|\S+|\S+:\S+/g,s,l=0;for(;(s=o.exec(t))!==null&&!(++l>100);){let u=s[0],c=u.indexOf(":");if(c!==-1){let f=u.slice(0,c),h=u.slice(c+1);h=(h+"").replace(/\\(.?)/g,function(d,m){switch(m){case"\\":return"\\";case"0":return"\0";case"":return"";default:return m}}),i.push({keyword:f,value:h,offsetStart:s.index,offsetEnd:s.index+u.length})}else{let f=!1;u[0]==="-"&&(f=!0,u=u.slice(1)),u=(u+"").replace(/\\(.?)/g,function(h,d){switch(d){case"\\":return"\\";case"0":return"\0";case"":return"";default:return d}}),f?r.text.push(u):i.push({text:u,offsetStart:s.index,offsetEnd:s.index+u.length})}}i.reverse();let a;for(;a=i.pop();)if(a.text)n.text.push(a.text),e.offsets&&n.offsets.push(a);else if(a.keyword){let u=a.keyword;e.keywords=e.keywords||[];let c=!1,f=!1;if(!/^-/.test(u))c=e.keywords.indexOf(u)!==-1;else if(u[0]==="-"){let d=u.slice(1);c=e.keywords.indexOf(d)!==-1,c&&(u=d,f=!0)}e.ranges=e.ranges||[];let h=e.ranges.indexOf(u)!==-1;if(c){e.offsets&&n.offsets.push({keyword:u,value:a.value,offsetStart:f?a.offsetStart+1:a.offsetStart,offsetEnd:a.offsetEnd});let d=a.value;if(d.length){let m=d.split(",");f?r[u]?r[u]instanceof Array?m.length>1?r[u]=r[u].concat(m):r[u].push(d):(r[u]=[r[u]],r[u].push(d)):m.length>1?r[u]=m:e.alwaysArray?r[u]=[d]:r[u]=d:n[u]?n[u]instanceof Array?m.length>1?n[u]=n[u].concat(m):n[u].push(d):(n[u]=[n[u]],n[u].push(d)):m.length>1?n[u]=m:e.alwaysArray?n[u]=[d]:n[u]=d}}else if(h){e.offsets&&n.offsets.push(a);let d=a.value,m=d.split("-");n[u]={},m.length===2?(n[u].from=m[0],n[u].to=m[1]):n[u].from=d}else{let d=a.keyword+":"+a.value;n.text.push(d),e.offsets&&n.offsets.push({text:d,offsetStart:a.offsetStart,offsetEnd:a.offsetEnd})}}return n.exclude=r,n}var Se=class{constructor(e=""){this.segments=[];this.exclusions=[];let n=In(e.toLowerCase(),{tokenize:!0});this.exclusions=n.exclude.text.map(this.formatToken).filter(r=>!!r.value),this.segments=n.text.map(this.formatToken)}segmentsToStr(){return this.segments.map(({value:e})=>e).join(" ")}getExactTerms(){return this.segments.filter(({exact:e})=>e).map(({value:e})=>e)}formatToken(e){let n=on(e);return{value:n,exact:n!==e}}};function zn(t,e,n){let r=t.slice();return r[16]=e[n],r[18]=n,r}function Bn(t){let e,n;function r(...i){return t[6](t[18],...i)}return e=new On({props:{selected:t[18]===t[0],note:t[16]}}),e.$on("mousemove",r),e.$on("click",t[3]),{c(){K(e.$$.fragment)},m(i,o){G(e,i,o),n=!0},p(i,o){t=i;let s={};o&1&&(s.selected=t[18]===t[0]),o&4&&(s.note=t[16]),e.$set(s)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){T(e.$$.fragment,i),n=!1},d(i){j(e,i)}}}function Ln(t){let e;return{c(){e=k("center"),e.textContent="We found 0 result for your search here."},m(n,r){b(n,e,r)},d(n){n&&F(e)}}}function Rr(t){let e,n,r,i=t[2],o=[];for(let a=0;a<i.length;a+=1)o[a]=Bn(zn(t,i,a));let s=a=>T(o[a],1,1,()=>{o[a]=null}),l=!t[2].length&&t[1]&&Ln(t);return{c(){for(let a=0;a<o.length;a+=1)o[a].c();e=B(),l&&l.c(),n=xe()},m(a,u){for(let c=0;c<o.length;c+=1)o[c].m(a,u);b(a,e,u),l&&l.m(a,u),b(a,n,u),r=!0},p(a,u){if(u&13){i=a[2];let c;for(c=0;c<i.length;c+=1){let f=zn(a,i,c);o[c]?(o[c].p(f,u),C(o[c],1)):(o[c]=Bn(f),o[c].c(),C(o[c],1),o[c].m(e.parentNode,e))}for(fe(),c=i.length;c<o.length;c+=1)s(c);de()}!a[2].length&&a[1]?l||(l=Ln(a),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},i(a){if(!r){for(let u=0;u<i.length;u+=1)C(o[u]);r=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)T(o[u]);r=!1},d(a){Ve(o,a),a&&F(e),l&&l.d(a),a&&F(n)}}}function Hr(t){let e,n,r,i,o,s,l,a;return r=new qe({props:{value:Xe}}),r.$on("input",t[5]),o=new Je({props:{$$slots:{default:[Rr]},$$scope:{ctx:t}}}),{c(){e=k("div"),e.textContent="Omnisearch - Vault",n=B(),K(r.$$.fragment),i=B(),K(o.$$.fragment),s=B(),l=k("div"),l.innerHTML=`<div class="prompt-instruction"><span class="prompt-instruction-command">\u2191\u2193</span><span>to navigate</span></div> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">alt \u21B5</span> 
    <span>to expand in-note results</span></div> 
  <br/> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">\u21B5</span><span>to open</span></div> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">ctrl \u21B5</span> 
    <span>to open in a new pane</span></div> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">shift \u21B5</span> 
    <span>to create</span></div> 
  <div class="prompt-instruction"><span class="prompt-instruction-command">esc</span><span>to dismiss</span></div>`,S(e,"class","modal-title"),S(l,"class","prompt-instructions")},m(u,c){b(u,e,c),b(u,n,c),G(r,u,c),b(u,i,c),G(o,u,c),b(u,s,c),b(u,l,c),a=!0},p(u,[c]){let f={};c&0&&(f.value=Xe),r.$set(f);let h={};c&524295&&(h.$$scope={dirty:c,ctx:u}),o.$set(h)},i(u){a||(C(r.$$.fragment,u),C(o.$$.fragment,u),a=!0)},o(u){T(r.$$.fragment,u),T(o.$$.fragment,u),a=!1},d(u){u&&F(e),u&&F(n),j(r,u),u&&F(i),j(o,u),u&&F(s),u&&F(l)}}}var Xe="";function jr(t,e,n){let r,{modal:i}=e,o=0,s,l=[],a;le(()=>{n(1,s=Xe),$.on("vault","enter",f),$.on("vault","shift-enter",d),$.on("vault","ctrl-enter",h),$.on("vault","alt-enter",m),$.on("vault","arrow-up",()=>_(-1)),$.on("vault","arrow-down",()=>_(1))});async function u(){a=new Se(s),n(2,l=await Le(a)),Xe=s,n(0,o=0),v()}function c(){!r||(ze(r),i.close())}function f(){!r||(ze(r),i.close())}function h(){!r||(ze(r,!0),i.close())}async function d(){try{await fn(s)}catch(p){new Ye.Notice(p.message);return}i.close()}function m(){if(r){let p=app.vault.getAbstractFileByPath(r.path);p&&p instanceof Ye.TFile&&new Ce(app,p,s,i).open()}}function _(p){n(0,o=Ne(o+p,l.length)),v()}async function v(){await ue(),r&&document.querySelector(`[data-result-id="${r.path}"]`)?.scrollIntoView({behavior:"auto",block:"nearest"})}let g=p=>n(1,s=p.detail),y=(p,w)=>n(0,o=p);return t.$$set=p=>{"modal"in p&&n(4,i=p.modal)},t.$$.update=()=>{if(t.$$.dirty&2){e:s?u():n(2,l=[])}if(t.$$.dirty&5){e:r=l[o]}},[o,s,l,c,i,g,y]}var Pn=class extends L{constructor(e){super();V(this,e,jr,Hr,H,{modal:4})}},Rn=Pn;var Vn=ie(require("obsidian"));function Vr(t){let e,n=t[2].replace(t[3],oe)+"";return{c(){e=k("div"),S(e,"class","omnisearch-result__body")},m(r,i){b(r,e,i),e.innerHTML=n},p(r,i){i&12&&n!==(n=r[2].replace(r[3],oe)+"")&&(e.innerHTML=n)},d(r){r&&F(e)}}}function Wr(t){let e,n;return e=new Ke({props:{id:t[0].toString(),selected:t[1],$$slots:{default:[Vr]},$$scope:{ctx:t}}}),e.$on("mousemove",t[6]),e.$on("click",t[7]),{c(){K(e.$$.fragment)},m(r,i){G(e,r,i),n=!0},p(r,[i]){let o={};i&1&&(o.id=r[0].toString()),i&2&&(o.selected=r[1]),i&268&&(o.$$scope={dirty:i,ctx:r}),e.$set(o)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){T(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function Qr(t,e,n){let r,i,{offset:o}=e,{note:s}=e,{index:l=0}=e,{selected:a=!1}=e;function u(f){ne.call(this,t,f)}function c(f){ne.call(this,t,f)}return t.$$set=f=>{"offset"in f&&n(4,o=f.offset),"note"in f&&n(5,s=f.note),"index"in f&&n(0,l=f.index),"selected"in f&&n(1,a=f.selected)},t.$$.update=()=>{if(t.$$.dirty&32){e:n(3,r=se(s.foundWords))}if(t.$$.dirty&48){e:n(2,i=Oe(s?.content??"",o))}},[l,a,i,r,o,s,u,c]}var Hn=class extends L{constructor(e){super();V(this,e,Qr,Wr,H,{offset:4,note:5,index:0,selected:1})}},jn=Hn;function Wn(t,e,n){let r=t.slice();return r[14]=e[n],r[16]=n,r}function Ur(t){let e;return{c(){e=k("center"),e.textContent="We found 0 result for your search here."},m(n,r){b(n,e,r)},p:q,i:q,o:q,d(n){n&&F(e)}}}function Gr(t){let e,n,r=t[3],i=[];for(let s=0;s<r.length;s+=1)i[s]=Qn(Wn(t,r,s));let o=s=>T(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=xe()},m(s,l){for(let a=0;a<i.length;a+=1)i[a].m(s,l);b(s,e,l),n=!0},p(s,l){if(l&60){r=s[3];let a;for(a=0;a<r.length;a+=1){let u=Wn(s,r,a);i[a]?(i[a].p(u,l),C(i[a],1)):(i[a]=Qn(u),i[a].c(),C(i[a],1),i[a].m(e.parentNode,e))}for(fe(),a=r.length;a<i.length;a+=1)o(a);de()}},i(s){if(!n){for(let l=0;l<r.length;l+=1)C(i[l]);n=!0}},o(s){i=i.filter(Boolean);for(let l=0;l<i.length;l+=1)T(i[l]);n=!1},d(s){Ve(i,s),s&&F(e)}}}function Qn(t){let e,n;function r(...i){return t[10](t[16],...i)}return e=new jn({props:{offset:t[14],note:t[2],index:t[16],selected:t[16]===t[4]}}),e.$on("mousemove",r),e.$on("click",t[5]),{c(){K(e.$$.fragment)},m(i,o){G(e,i,o),n=!0},p(i,o){t=i;let s={};o&8&&(s.offset=t[14]),o&4&&(s.note=t[2]),o&16&&(s.selected=t[16]===t[4]),e.$set(s)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){T(e.$$.fragment,i),n=!1},d(i){j(e,i)}}}function qr(t){let e,n,r,i,o=[Gr,Ur],s=[];function l(a,u){return a[3].length&&a[2]?0:1}return e=l(t,-1),n=s[e]=o[e](t),{c(){n.c(),r=xe()},m(a,u){s[e].m(a,u),b(a,r,u),i=!0},p(a,u){let c=e;e=l(a,u),e===c?s[e].p(a,u):(fe(),T(s[c],1,1,()=>{s[c]=null}),de(),n=s[e],n?n.p(a,u):(n=s[e]=o[e](a),n.c()),C(n,1),n.m(r.parentNode,r))},i(a){i||(C(n),i=!0)},o(a){T(n),i=!1},d(a){s[e].d(a),a&&F(r)}}}function Jr(t){let e;return{c(){e=k("span"),e.textContent="to dismiss"},m(n,r){b(n,e,r)},d(n){n&&F(e)}}}function Kr(t){let e;return{c(){e=k("span"),e.textContent="to go back to Vault Search"},m(n,r){b(n,e,r)},d(n){n&&F(e)}}}function Yr(t){let e,n,r,i,o,s,l,a,u,c,f,h,d,m,_;r=new qe({props:{value:t[0]}}),r.$on("input",t[9]),o=new Je({props:{$$slots:{default:[qr]},$$scope:{ctx:t}}});function v(p,w){return p[1]?Kr:Jr}let g=v(t,-1),y=g(t);return{c(){e=k("div"),e.textContent="Omnisearch - File",n=B(),K(r.$$.fragment),i=B(),K(o.$$.fragment),s=B(),l=k("div"),a=k("div"),a.innerHTML='<span class="prompt-instruction-command">\u2191\u2193</span><span>to navigate</span>',u=B(),c=k("div"),c.innerHTML='<span class="prompt-instruction-command">\u21B5</span><span>to open</span>',f=B(),h=k("div"),d=k("span"),d.textContent="esc",m=B(),y.c(),S(e,"class","modal-title"),S(a,"class","prompt-instruction"),S(c,"class","prompt-instruction"),S(d,"class","prompt-instruction-command"),S(h,"class","prompt-instruction"),S(l,"class","prompt-instructions")},m(p,w){b(p,e,w),b(p,n,w),G(r,p,w),b(p,i,w),G(o,p,w),b(p,s,w),b(p,l,w),J(l,a),J(l,u),J(l,c),J(l,f),J(l,h),J(h,d),J(h,m),y.m(h,null),_=!0},p(p,[w]){let x={};w&1&&(x.value=p[0]),r.$set(x);let A={};w&131100&&(A.$$scope={dirty:w,ctx:p}),o.$set(A),g!==(g=v(p,w))&&(y.d(1),y=g(p),y&&(y.c(),y.m(h,null)))},i(p){_||(C(r.$$.fragment,p),C(o.$$.fragment,p),_=!0)},o(p){T(r.$$.fragment,p),T(o.$$.fragment,p),_=!1},d(p){p&&F(e),p&&F(n),j(r,p),p&&F(i),j(o,p),p&&F(s),p&&F(l),y.d()}}}var kt="";function Xr(t,e,n){let r=t.find(i=>i.offset>e);return r?t.filter(i=>i.offset>e&&i.offset<=r.offset+n):[]}function Zr(t,e,n){let{modal:r}=e,{parent:i=null}=e,{singleFilePath:o=""}=e,{searchQuery:s}=e,l=[],a=0,u=null,c;le(()=>{kt&&!s&&n(0,s=kt),$.disable("vault"),$.on("infile","enter",m),$.on("infile","arrow-up",()=>h(-1)),$.on("infile","arrow-down",()=>h(1))}),bt(()=>{$.enable("vault")});function f(g){let y=[],p=-1,w=0;for(;;){let x=Xr(g,p,Te);if(!x.length||(p=x.last().offset,y.push(x),++w>100))break}return y}function h(g){n(4,a=Ne(a+g,l.length)),d()}async function d(){await ue(),document.querySelector(`[data-result-id="${a}"]`)?.scrollIntoView({behavior:"auto",block:"nearest"})}async function m(){if(u){r.close(),i&&i.close(),await app.workspace.openLinkText(u.path,"");let g=app.workspace.getActiveViewOfType(Vn.MarkdownView);if(!g)throw new Error("OmniSearch - No active MarkdownView");let y=l[a]??0,p=g.editor.offsetToPos(y);p.ch=0,g.editor.setCursor(p),g.editor.scrollIntoView({from:{line:p.line-10,ch:0},to:{line:p.line+10,ch:0}})}}let _=g=>n(0,s=g.detail),v=(g,y)=>n(4,a=g);return t.$$set=g=>{"modal"in g&&n(6,r=g.modal),"parent"in g&&n(1,i=g.parent),"singleFilePath"in g&&n(7,o=g.singleFilePath),"searchQuery"in g&&n(0,s=g.searchQuery)},t.$$.update=()=>{if(t.$$.dirty&385){e:(async()=>{s&&(n(8,c=new Se(s)),n(2,u=(await Le(c,{singleFilePath:o}))[0]??null),kt=s),n(4,a=0),d()})()}if(t.$$.dirty&4){e:if(u){let g=f(u.matches);n(3,l=g.map(y=>Math.round((y.first().offset+y.last().offset)/2)))}}},[s,i,u,l,a,m,r,o,c,_,v]}var Un=class extends L{constructor(e){super();V(this,e,Zr,Yr,H,{modal:6,parent:1,singleFilePath:7,searchQuery:0})}},Gn=Un;var Mt=class extends qn.Modal{constructor(e){super(e);let n=this.containerEl.find(".modal-close-button");this.modalEl.replaceChildren(),this.modalEl.append(n),this.modalEl.addClass("omnisearch-modal","prompt"),this.modalEl.removeClass("modal"),this.modalEl.tabIndex=-1,this.scope.register([],"ArrowDown",r=>{r.preventDefault(),$.emit("arrow-down")}),this.scope.register([],"ArrowUp",r=>{r.preventDefault(),$.emit("arrow-up")}),this.scope.register(["Ctrl"],"Enter",r=>{r.preventDefault(),$.emit("ctrl-enter")}),this.scope.register(["Meta"],"Enter",r=>{r.preventDefault(),$.emit("ctrl-enter")}),this.scope.register(["Alt"],"Enter",r=>{r.preventDefault(),$.emit("alt-enter")}),this.scope.register(["Shift"],"Enter",r=>{r.preventDefault(),$.emit("shift-enter")}),this.scope.register([],"Enter",r=>{tn()||(r.preventDefault(),$.emit("enter"))})}},Dt=class extends Mt{constructor(e){super(e);let n=new Rn({target:this.modalEl,props:{modal:this}});this.onClose=()=>{n.$destroy()}}},Ce=class extends Mt{constructor(e,n,r="",i){super(e);let o=new Gn({target:this.modalEl,props:{modal:this,singleFilePath:n.path,parent:i,searchQuery:r}});i&&i.containerEl.toggleVisibility(!1),this.onClose=()=>{i&&i.containerEl.toggleVisibility(!0),o.$destroy()}}};var ke=null;try{ke=require("electron").remote.getCurrentWindow()}catch{console.log("Can't load electron, mobile platform")}var Jn=()=>{mn()},Tt=class extends Ze.Plugin{async onload(){ke&&ke.on("blur",Jn),await an(this),this.addSettingTab(new dt(this)),this.addCommand({id:"show-modal",name:"Vault search",callback:()=>{new Dt(app).open()}}),this.addCommand({id:"show-modal-infile",name:"In-file search",editorCallback:(e,n)=>{new Ce(app,n.file).open()}}),app.workspace.onLayoutReady(async()=>{this.registerEvent(this.app.vault.on("create",e=>{ge(e)})),this.registerEvent(this.app.vault.on("delete",e=>{ae(e.path)})),this.registerEvent(this.app.vault.on("modify",async e=>{N.reindexInRealTime?(ae(e.path),await ge(e)):pn(e)})),this.registerEvent(this.app.vault.on("rename",async(e,n)=>{e instanceof Ze.TFile&&e.path.endsWith(".md")&&(ae(n),await ge(e))})),await hn()})}onunload(){ke&&ke.off("blur",Jn)}};
